{
  "model": "gemini-3-flash",
  "strategy": "chain_of_thought_prompting",
  "context_type": "interface",
  "timestamp": "2025-12-30T01:43:56.665842",
  "response_time": 84.83707356452942,
  "test_file": "cli_results\\chain_of_thought_prompting\\interface\\gemini-3-flash\\run_021\\tests.py",
  "raw_results": {
    "responses": [
      {
        "step": 1,
        "prompt": "You are a software testing assistant. Your task is to generate a set of unit tests for a Python class provided below.\n\nThe tests should:\n- use the `unittest` framework,\n- cover all public methods,\n- test typical usage as well as edge cases, invalid inputs, and exceptions,\n- be clear, atomic, and minimal.\n\nYou will now analyze the class to prepare relevant test cases.\nDo not write test code yet. Do not write test scenarios yet. Just analyze the class and prepare for the next step.\n\nBelow is the class interface (without implementation):\n\n```python\nfrom typing import TypedDict, List\n\nclass Item(TypedDict)\n\nclass OrderCalculator:\n    def __init__(self, tax_rate=0.23, free_shipping_threshold=100.0, shipping_cost=10.0):\n\ndef add_item(self, name: str, price: float, quantity: int = 1):\n\ndef remove_item(self, name: str):\n\ndef get_subtotal(self) -> float:\n\ndef apply_discount(self, subtotal: float, discount: float) -> float:\n\ndef calculate_shipping(self, discounted_subtotal: float) -> float:\n\ndef calculate_tax(self, amount: float) -> float:\n\ndef calculate_total(self, discount: float = 0.0) -> float:\n\ndef total_items(self) -> int:\n\ndef clear_order(self):\n\ndef list_items(self) -> List[str]:\n\ndef is_empty(self) -> bool:\n\n```\n\n",
        "response": "I have analyzed the `OrderCalculator` class interface. Here is an overview of the components I will be considering for testing:\n\n### 1. State Management\n*   **Initialization:** How `tax_rate`, `free_shipping_threshold`, and `shipping_cost` are stored and used as defaults.\n*   **Item Storage:** How the internal collection of `Item` objects is managed via `add_item`, `remove_item`, `clear_order`, and `is_empty`.\n\n### 2. Core Calculations\n*   **Subtotal Logic:** Multiplication of price and quantity across all items.\n*   **Discount Application:** How the `discount` (likely a fixed value or percentage) reduces the subtotal.\n*   **Shipping Logic:** The conditional logic applying `shipping_cost` only when the `discounted_subtotal` is below the `free_shipping_threshold`.\n*   **Tax Logic:** Calculation of tax based on the `tax_rate`.\n*   **Grand Total:** The orchestration of subtotal, discount, shipping, and tax calculations.\n\n### 3. Edge Cases and Inputs\n*   **Empty States:** Behavior of calculation methods when no items are present.\n*   **Input Validation:** Handling of negative prices, quantities, or discounts; non-existent items in `remove_item`; and zero/negative configuration values in `__init__`.\n*   **Boundary Conditions:** Orders exactly at, just below, or just above the `free_shipping_threshold`.\n\nI am ready to proceed with defining specific test scenarios or generating the implementation.",
        "response_time": 0
      },
      {
        "step": 2,
        "prompt": "Based on the class above, list all relevant unit test scenarios you would create.\nEach scenario should describe:\n- the method being tested,\n- the type of case (e.g. normal use, invalid input, exception),\n- a short explanation of the intent.\nList as many scenarios as you can think of, covering all aspects of the class.\nDo not write test code yet.\n\n",
        "response": "Based on the `OrderCalculator` interface, here are the relevant unit test scenarios grouped by functionality:\n\n### 1. Initialization (`__init__`)\n- **Scenario: Default values.** (Normal) Verify that the calculator initializes with the specified default tax rate (0.23), threshold (100.0), and shipping cost (10.0).\n- **Scenario: Custom valid values.** (Normal) Verify that custom values for tax rate, threshold, and shipping are correctly stored and used.\n- **Scenario: Invalid tax rate.** (Invalid input) Test behavior when a negative tax rate is provided.\n- **Scenario: Invalid shipping threshold.** (Invalid input) Test behavior when a negative shipping threshold is provided.\n- **Scenario: Invalid shipping cost.** (Invalid input) Test behavior when a negative shipping cost is provided.\n\n### 2. Managing Items (`add_item`, `remove_item`, `clear_order`)\n- **Scenario: Add single item.** (Normal) Add one item with default quantity (1) and verify it's stored.\n- **Scenario: Add item with custom quantity.** (Normal) Add an item with quantity > 1.\n- **Scenario: Add multiple items.** (Normal) Add several different items and verify the collection grows.\n- **Scenario: Add item with invalid price.** (Invalid input) Test adding an item with a negative price.\n- **Scenario: Add item with invalid quantity.** (Invalid input) Test adding an item with zero or negative quantity.\n- **Scenario: Add item with empty name.** (Invalid input) Test behavior when name is an empty string.\n- **Scenario: Remove existing item.** (Normal) Remove an item by name and verify it is no longer in the order.\n- **Scenario: Remove non-existent item.** (Exception/Edge case) Test removing a name that wasn't added (should likely raise a `ValueError` or `KeyError`).\n- **Scenario: Clear non-empty order.** (Normal) Add items, call `clear_order`, and verify the order is empty.\n- **Scenario: Clear already empty order.** (Edge case) Call `clear_order` on a new instance.\n\n### 3. State Queries (`total_items`, `list_items`, `is_empty`)\n- **Scenario: Check `is_empty` on new instance.** (Normal) Should return `True`.\n- **Scenario: Check `is_empty` after adding item.** (Normal) Should return `False`.\n- **Scenario: Check `is_empty` after removing all items.** (Edge case) Should return `True`.\n- **Scenario: `total_items` count.** (Normal) Verify it returns the sum of quantities (e.g., adding 2 Apples and 1 Orange should return 3).\n- **Scenario: `list_items` format.** (Normal) Verify it returns a list of strings representing the items currently in the order.\n- **Scenario: `list_items` on empty order.** (Normal) Should return an empty list.\n\n### 4. Subtotal and Discount logic (`get_subtotal`, `apply_discount`)\n- **Scenario: `get_subtotal` empty.** (Normal) Should return 0.0.\n- **Scenario: `get_subtotal` multiple items.** (Normal) Verify calculation: `sum(price * quantity)`.\n- **Scenario: `apply_discount` zero.** (Normal) Verify subtotal remains unchanged.\n- **Scenario: `apply_discount` valid amount.** (Normal) Verify it correctly subtracts the discount from the subtotal.\n- **Scenario: `apply_discount` exceeding subtotal.** (Edge case) Verify if the result is capped at 0.0 or allowed to be negative.\n- **Scenario: `apply_discount` negative.** (Invalid input) Test behavior with a negative discount value.\n\n### 5. Shipping and Tax logic (`calculate_shipping`, `calculate_tax`)\n- **Scenario: Shipping below threshold.** (Normal) Subtotal < threshold should return the configured `shipping_cost`.\n- **Scenario: Shipping at threshold.** (Edge case) Subtotal == threshold (verify if free or not based on business rule).\n- **Scenario: Shipping above threshold.** (Normal) Subtotal > threshold should return 0.0.\n- **Scenario: Shipping for zero subtotal.** (Edge case) Verify if shipping is applied to an empty order.\n- **Scenario: Tax calculation.** (Normal) Verify `amount * tax_rate`.\n- **Scenario: Tax on zero amount.** (Normal) Should return 0.0.\n- **Scenario: Tax with 0% tax rate.** (Edge case) Should return 0.0 regardless of amount.\n\n### 6. Grand Total Integration (`calculate_total`)\n- **Scenario: Total for empty order.** (Edge case) Verify if it returns 0.0 or just the shipping cost.\n- **Scenario: Total without discount (standard).** (Normal) Verify: `(Subtotal + Shipping) * (1 + Tax)`.\n- **Scenario: Total with discount (no shipping change).** (Normal) Discounted subtotal still above/below threshold.\n- **Scenario: Total with discount triggering free shipping.** (Edge case) Subtotal is above threshold, but discount brings it below (or vice versa, depending on which subtotal is used for shipping calculation).\n- **Scenario: Integration check.** (Normal) Full flow: multiple items, specific discount, tax, and shipping combined.",
        "response_time": 0
      },
      {
        "step": 3,
        "prompt": "Now, based on the test scenarios you just listed, generate the complete Python unit test suite using the `unittest` framework.\n\nFollow these rules:\n- Include one test method per scenario.\n- Use meaningful test method names.\n- Do not include comments or explanations.\n- Output a valid `.py` file containing only the test class.\n- IMPORTANT: Do NOT copy or redefine the OrderCalculator class in your test file. The class already exists in a separate module. Simply import it using: `from order_calculator import OrderCalculator`\n\nThe output must contain only Python code.",
        "response": "```python\nimport unittest\nfrom order_calculator import OrderCalculator\n\nclass TestOrderCalculator(unittest.TestCase):\n\n    def setUp(self):\n        self.calculator = OrderCalculator()\n\n    def test_init_default_values(self):\n        calc = OrderCalculator()\n        self.assertEqual(calc.get_subtotal(), 0.0)\n        self.assertEqual(calc.calculate_tax(100), 23.0)\n        self.assertEqual(calc.calculate_shipping(50), 10.0)\n\n    def test_init_custom_valid_values(self):\n        calc = OrderCalculator(tax_rate=0.1, free_shipping_threshold=200.0, shipping_cost=15.0)\n        self.assertEqual(calc.calculate_tax(100), 10.0)\n        self.assertEqual(calc.calculate_shipping(150), 15.0)\n        self.assertEqual(calc.calculate_shipping(250), 0.0)\n\n    def test_init_invalid_tax_rate(self):\n        with self.assertRaises(ValueError):\n            OrderCalculator(tax_rate=-0.1)\n\n    def test_init_invalid_shipping_threshold(self):\n        with self.assertRaises(ValueError):\n            OrderCalculator(free_shipping_threshold=-10.0)\n\n    def test_init_invalid_shipping_cost(self):\n        with self.assertRaises(ValueError):\n            OrderCalculator(shipping_cost=-5.0)\n\n    def test_add_item_single_default_quantity(self):\n        self.calculator.add_item(\"Apple\", 2.0)\n        self.assertEqual(self.calculator.total_items(), 1)\n        self.assertIn(\"Apple\", self.calculator.list_items()[0])\n\n    def test_add_item_custom_quantity(self):\n        self.calculator.add_item(\"Apple\", 2.0, 5)\n        self.assertEqual(self.calculator.total_items(), 5)\n\n    def test_add_multiple_items(self):\n        self.calculator.add_item(\"Apple\", 2.0, 2)\n        self.calculator.add_item(\"Banana\", 1.0, 3)\n        self.assertEqual(self.calculator.total_items(), 5)\n        self.assertEqual(len(self.calculator.list_items()), 2)\n\n    def test_add_item_invalid_price(self):\n        with self.assertRaises(ValueError):\n            self.calculator.add_item(\"Apple\", -2.0)\n\n    def test_add_item_invalid_quantity(self):\n        with self.assertRaises(ValueError):\n            self.calculator.add_item(\"Apple\", 2.0, 0)\n        with self.assertRaises(ValueError):\n            self.calculator.add_item(\"Apple\", 2.0, -1)\n\n    def test_add_item_empty_name(self):\n        with self.assertRaises(ValueError):\n            self.calculator.add_item(\"\", 2.0)\n\n    def test_remove_existing_item(self):\n        self.calculator.add_item(\"Apple\", 2.0)\n        self.calculator.remove_item(\"Apple\")\n        self.assertTrue(self.calculator.is_empty())\n\n    def test_remove_non_existent_item(self):\n        with self.assertRaises((ValueError, KeyError)):\n            self.calculator.remove_item(\"Orange\")\n\n    def test_clear_non_empty_order(self):\n        self.calculator.add_item(\"Apple\", 2.0)\n        self.calculator.clear_order()\n        self.assertTrue(self.calculator.is_empty())\n        self.assertEqual(self.calculator.total_items(), 0)\n\n    def test_clear_empty_order(self):\n        self.calculator.clear_order()\n        self.assertTrue(self.calculator.is_empty())\n\n    def test_is_empty_new_instance(self):\n        self.assertTrue(self.calculator.is_empty())\n\n    def test_is_empty_after_add(self):\n        self.calculator.add_item(\"Apple\", 2.0)\n        self.assertFalse(self.calculator.is_empty())\n\n    def test_is_empty_after_removing_all(self):\n        self.calculator.add_item(\"Apple\", 2.0)\n        self.calculator.remove_item(\"Apple\")\n        self.assertTrue(self.calculator.is_empty())\n\n    def test_total_items_count(self):\n        self.calculator.add_item(\"Apple\", 2.0, 2)\n        self.calculator.add_item(\"Orange\", 3.0, 1)\n        self.assertEqual(self.calculator.total_items(), 3)\n\n    def test_list_items_format(self):\n        self.calculator.add_item(\"Apple\", 2.0, 1)\n        items = self.calculator.list_items()\n        self.assertIsInstance(items, list)\n        self.assertIsInstance(items[0], str)\n\n    def test_list_items_empty(self):\n        self.assertEqual(self.calculator.list_items(), [])\n\n    def test_get_subtotal_empty(self):\n        self.assertEqual(self.calculator.get_subtotal(), 0.0)\n\n    def test_get_subtotal_multiple_items(self):\n        self.calculator.add_item(\"Apple\", 10.0, 2)\n        self.calculator.add_item(\"Orange\", 5.0, 1)\n        self.assertEqual(self.calculator.get_subtotal(), 25.0)\n\n    def test_apply_discount_zero(self):\n        subtotal = 100.0\n        self.assertEqual(self.calculator.apply_discount(subtotal, 0.0), 100.0)\n\n    def test_apply_discount_valid(self):\n        subtotal = 100.0\n        self.assertEqual(self.calculator.apply_discount(subtotal, 20.0), 80.0)\n\n    def test_apply_discount_exceeding_subtotal(self):\n        subtotal = 50.0\n        self.assertEqual(self.calculator.apply_discount(subtotal, 60.0), 0.0)\n\n    def test_apply_discount_negative(self):\n        with self.assertRaises(ValueError):\n            self.calculator.apply_discount(100.0, -10.0)\n\n    def test_calculate_shipping_below_threshold(self):\n        self.assertEqual(self.calculator.calculate_shipping(50.0), 10.0)\n\n    def test_calculate_shipping_at_threshold(self):\n        threshold = self.calculator.free_shipping_threshold\n        self.assertEqual(self.calculator.calculate_shipping(threshold), 0.0)\n\n    def test_calculate_shipping_above_threshold(self):\n        self.assertEqual(self.calculator.calculate_shipping(150.0), 0.0)\n\n    def test_calculate_shipping_zero_subtotal(self):\n        self.assertEqual(self.calculator.calculate_shipping(0.0), 0.0)\n\n    def test_calculate_tax_standard(self):\n        self.calculator = OrderCalculator(tax_rate=0.2)\n        self.assertEqual(self.calculator.calculate_tax(100.0), 20.0)\n\n    def test_calculate_tax_zero_amount(self):\n        self.assertEqual(self.calculator.calculate_tax(0.0), 0.0)\n\n    def test_calculate_tax_zero_rate(self):\n        calc = OrderCalculator(tax_rate=0.0)\n        self.assertEqual(calc.calculate_tax(100.0), 0.0)\n\n    def test_calculate_total_empty_order(self):\n        self.assertEqual(self.calculator.calculate_total(), 0.0)\n\n    def test_calculate_total_without_discount(self):\n        self.calculator.add_item(\"Item\", 50.0, 1)\n        subtotal = 50.0\n        shipping = 10.0\n        tax = (subtotal + shipping) * 0.23\n        expected = subtotal + shipping + tax\n        self.assertAlmostEqual(self.calculator.calculate_total(), expected)\n\n    def test_calculate_total_with_discount_no_shipping_change(self):\n        self.calculator.add_item(\"Item\", 150.0, 1)\n        discount = 10.0\n        discounted_subtotal = 140.0\n        shipping = 0.0\n        tax = (discounted_subtotal + shipping) * 0.23\n        expected = discounted_subtotal + shipping + tax\n        self.assertAlmostEqual(self.calculator.calculate_total(discount=discount), expected)\n\n    def test_calculate_total_with_discount_triggering_shipping(self):\n        self.calculator.add_item(\"Item\", 105.0, 1)\n        discount = 10.0\n        discounted_subtotal = 95.0\n        shipping = 10.0\n        tax = (discounted_subtotal + shipping) * 0.23\n        expected = discounted_subtotal + shipping + tax\n        self.assertAlmostEqual(self.calculator.calculate_total(discount=discount), expected)\n\n    def test_calculate_total_integration(self):\n        calc = OrderCalculator(tax_rate=0.1, free_shipping_threshold=100.0, shipping_cost=20.0)\n        calc.add_item(\"A\", 30.0, 2)\n        calc.add_item(\"B\", 20.0, 1)\n        subtotal = 80.0\n        discount = 10.0\n        discounted_subtotal = 70.0\n        shipping = 20.0\n        tax = (70.0 + 20.0) * 0.1\n        expected = 70.0 + 20.0 + 9.0\n        self.assertAlmostEqual(calc.calculate_total(discount=10.0), expected)\n\nif __name__ == '__main__':\n    unittest.main()\n```",
        "response_time": 0
      }
    ],
    "final_response": "```python\nimport unittest\nfrom order_calculator import OrderCalculator\n\nclass TestOrderCalculator(unittest.TestCase):\n\n    def setUp(self):\n        self.calculator = OrderCalculator()\n\n    def test_init_default_values(self):\n        calc = OrderCalculator()\n        self.assertEqual(calc.get_subtotal(), 0.0)\n        self.assertEqual(calc.calculate_tax(100), 23.0)\n        self.assertEqual(calc.calculate_shipping(50), 10.0)\n\n    def test_init_custom_valid_values(self):\n        calc = OrderCalculator(tax_rate=0.1, free_shipping_threshold=200.0, shipping_cost=15.0)\n        self.assertEqual(calc.calculate_tax(100), 10.0)\n        self.assertEqual(calc.calculate_shipping(150), 15.0)\n        self.assertEqual(calc.calculate_shipping(250), 0.0)\n\n    def test_init_invalid_tax_rate(self):\n        with self.assertRaises(ValueError):\n            OrderCalculator(tax_rate=-0.1)\n\n    def test_init_invalid_shipping_threshold(self):\n        with self.assertRaises(ValueError):\n            OrderCalculator(free_shipping_threshold=-10.0)\n\n    def test_init_invalid_shipping_cost(self):\n        with self.assertRaises(ValueError):\n            OrderCalculator(shipping_cost=-5.0)\n\n    def test_add_item_single_default_quantity(self):\n        self.calculator.add_item(\"Apple\", 2.0)\n        self.assertEqual(self.calculator.total_items(), 1)\n        self.assertIn(\"Apple\", self.calculator.list_items()[0])\n\n    def test_add_item_custom_quantity(self):\n        self.calculator.add_item(\"Apple\", 2.0, 5)\n        self.assertEqual(self.calculator.total_items(), 5)\n\n    def test_add_multiple_items(self):\n        self.calculator.add_item(\"Apple\", 2.0, 2)\n        self.calculator.add_item(\"Banana\", 1.0, 3)\n        self.assertEqual(self.calculator.total_items(), 5)\n        self.assertEqual(len(self.calculator.list_items()), 2)\n\n    def test_add_item_invalid_price(self):\n        with self.assertRaises(ValueError):\n            self.calculator.add_item(\"Apple\", -2.0)\n\n    def test_add_item_invalid_quantity(self):\n        with self.assertRaises(ValueError):\n            self.calculator.add_item(\"Apple\", 2.0, 0)\n        with self.assertRaises(ValueError):\n            self.calculator.add_item(\"Apple\", 2.0, -1)\n\n    def test_add_item_empty_name(self):\n        with self.assertRaises(ValueError):\n            self.calculator.add_item(\"\", 2.0)\n\n    def test_remove_existing_item(self):\n        self.calculator.add_item(\"Apple\", 2.0)\n        self.calculator.remove_item(\"Apple\")\n        self.assertTrue(self.calculator.is_empty())\n\n    def test_remove_non_existent_item(self):\n        with self.assertRaises((ValueError, KeyError)):\n            self.calculator.remove_item(\"Orange\")\n\n    def test_clear_non_empty_order(self):\n        self.calculator.add_item(\"Apple\", 2.0)\n        self.calculator.clear_order()\n        self.assertTrue(self.calculator.is_empty())\n        self.assertEqual(self.calculator.total_items(), 0)\n\n    def test_clear_empty_order(self):\n        self.calculator.clear_order()\n        self.assertTrue(self.calculator.is_empty())\n\n    def test_is_empty_new_instance(self):\n        self.assertTrue(self.calculator.is_empty())\n\n    def test_is_empty_after_add(self):\n        self.calculator.add_item(\"Apple\", 2.0)\n        self.assertFalse(self.calculator.is_empty())\n\n    def test_is_empty_after_removing_all(self):\n        self.calculator.add_item(\"Apple\", 2.0)\n        self.calculator.remove_item(\"Apple\")\n        self.assertTrue(self.calculator.is_empty())\n\n    def test_total_items_count(self):\n        self.calculator.add_item(\"Apple\", 2.0, 2)\n        self.calculator.add_item(\"Orange\", 3.0, 1)\n        self.assertEqual(self.calculator.total_items(), 3)\n\n    def test_list_items_format(self):\n        self.calculator.add_item(\"Apple\", 2.0, 1)\n        items = self.calculator.list_items()\n        self.assertIsInstance(items, list)\n        self.assertIsInstance(items[0], str)\n\n    def test_list_items_empty(self):\n        self.assertEqual(self.calculator.list_items(), [])\n\n    def test_get_subtotal_empty(self):\n        self.assertEqual(self.calculator.get_subtotal(), 0.0)\n\n    def test_get_subtotal_multiple_items(self):\n        self.calculator.add_item(\"Apple\", 10.0, 2)\n        self.calculator.add_item(\"Orange\", 5.0, 1)\n        self.assertEqual(self.calculator.get_subtotal(), 25.0)\n\n    def test_apply_discount_zero(self):\n        subtotal = 100.0\n        self.assertEqual(self.calculator.apply_discount(subtotal, 0.0), 100.0)\n\n    def test_apply_discount_valid(self):\n        subtotal = 100.0\n        self.assertEqual(self.calculator.apply_discount(subtotal, 20.0), 80.0)\n\n    def test_apply_discount_exceeding_subtotal(self):\n        subtotal = 50.0\n        self.assertEqual(self.calculator.apply_discount(subtotal, 60.0), 0.0)\n\n    def test_apply_discount_negative(self):\n        with self.assertRaises(ValueError):\n            self.calculator.apply_discount(100.0, -10.0)\n\n    def test_calculate_shipping_below_threshold(self):\n        self.assertEqual(self.calculator.calculate_shipping(50.0), 10.0)\n\n    def test_calculate_shipping_at_threshold(self):\n        threshold = self.calculator.free_shipping_threshold\n        self.assertEqual(self.calculator.calculate_shipping(threshold), 0.0)\n\n    def test_calculate_shipping_above_threshold(self):\n        self.assertEqual(self.calculator.calculate_shipping(150.0), 0.0)\n\n    def test_calculate_shipping_zero_subtotal(self):\n        self.assertEqual(self.calculator.calculate_shipping(0.0), 0.0)\n\n    def test_calculate_tax_standard(self):\n        self.calculator = OrderCalculator(tax_rate=0.2)\n        self.assertEqual(self.calculator.calculate_tax(100.0), 20.0)\n\n    def test_calculate_tax_zero_amount(self):\n        self.assertEqual(self.calculator.calculate_tax(0.0), 0.0)\n\n    def test_calculate_tax_zero_rate(self):\n        calc = OrderCalculator(tax_rate=0.0)\n        self.assertEqual(calc.calculate_tax(100.0), 0.0)\n\n    def test_calculate_total_empty_order(self):\n        self.assertEqual(self.calculator.calculate_total(), 0.0)\n\n    def test_calculate_total_without_discount(self):\n        self.calculator.add_item(\"Item\", 50.0, 1)\n        subtotal = 50.0\n        shipping = 10.0\n        tax = (subtotal + shipping) * 0.23\n        expected = subtotal + shipping + tax\n        self.assertAlmostEqual(self.calculator.calculate_total(), expected)\n\n    def test_calculate_total_with_discount_no_shipping_change(self):\n        self.calculator.add_item(\"Item\", 150.0, 1)\n        discount = 10.0\n        discounted_subtotal = 140.0\n        shipping = 0.0\n        tax = (discounted_subtotal + shipping) * 0.23\n        expected = discounted_subtotal + shipping + tax\n        self.assertAlmostEqual(self.calculator.calculate_total(discount=discount), expected)\n\n    def test_calculate_total_with_discount_triggering_shipping(self):\n        self.calculator.add_item(\"Item\", 105.0, 1)\n        discount = 10.0\n        discounted_subtotal = 95.0\n        shipping = 10.0\n        tax = (discounted_subtotal + shipping) * 0.23\n        expected = discounted_subtotal + shipping + tax\n        self.assertAlmostEqual(self.calculator.calculate_total(discount=discount), expected)\n\n    def test_calculate_total_integration(self):\n        calc = OrderCalculator(tax_rate=0.1, free_shipping_threshold=100.0, shipping_cost=20.0)\n        calc.add_item(\"A\", 30.0, 2)\n        calc.add_item(\"B\", 20.0, 1)\n        subtotal = 80.0\n        discount = 10.0\n        discounted_subtotal = 70.0\n        shipping = 20.0\n        tax = (70.0 + 20.0) * 0.1\n        expected = 70.0 + 20.0 + 9.0\n        self.assertAlmostEqual(calc.calculate_total(discount=10.0), expected)\n\nif __name__ == '__main__':\n    unittest.main()\n```",
    "total_response_time": 84.83707356452942,
    "strategy": "chain_of_thought_prompting",
    "context_type": "interface"
  }
}