{
  "model": "claude-code-opus-4.5",
  "strategy": "chain_of_thought_prompting",
  "context_type": "interface",
  "timestamp": "2025-12-30T19:55:30.401823",
  "response_time": 158.47605514526367,
  "test_file": "cli_results\\chain_of_thought_prompting\\interface\\claude-code-opus-4.5\\run_015\\tests.py",
  "raw_results": {
    "responses": [
      {
        "step": 1,
        "prompt": "You are a software testing assistant. Your task is to generate a set of unit tests for a Python class provided below.\n\nThe tests should:\n- use the `unittest` framework,\n- cover all public methods,\n- test typical usage as well as edge cases, invalid inputs, and exceptions,\n- be clear, atomic, and minimal.\n\nYou will now analyze the class to prepare relevant test cases.\nDo not write test code yet. Do not write test scenarios yet. Just analyze the class and prepare for the next step.\n\nBelow is the class interface (without implementation):\n\n```python\nfrom typing import TypedDict, List\n\nclass Item(TypedDict)\n\nclass OrderCalculator:\n    def __init__(self, tax_rate=0.23, free_shipping_threshold=100.0, shipping_cost=10.0):\n\ndef add_item(self, name: str, price: float, quantity: int = 1):\n\ndef remove_item(self, name: str):\n\ndef get_subtotal(self) -> float:\n\ndef apply_discount(self, subtotal: float, discount: float) -> float:\n\ndef calculate_shipping(self, discounted_subtotal: float) -> float:\n\ndef calculate_tax(self, amount: float) -> float:\n\ndef calculate_total(self, discount: float = 0.0) -> float:\n\ndef total_items(self) -> int:\n\ndef clear_order(self):\n\ndef list_items(self) -> List[str]:\n\ndef is_empty(self) -> bool:\n\n```\n\n",
        "response": "I'll analyze the `OrderCalculator` class to prepare for generating comprehensive unit tests.\n\n## Class Analysis\n\n### Class Purpose\n`OrderCalculator` is an e-commerce order management class that handles items in a shopping cart, calculates subtotals, applies discounts, computes shipping costs, calculates taxes, and provides the final total.\n\n### Constructor Parameters\n- `tax_rate`: Default 0.23 (23%) - percentage for tax calculation\n- `free_shipping_threshold`: Default 100.0 - subtotal above which shipping is free\n- `shipping_cost`: Default 10.0 - flat shipping fee when below threshold\n\n### Public Methods to Test\n\n1. **`add_item(name, price, quantity=1)`**\n   - Adds item with name, price, and optional quantity\n   - Edge cases: empty name, negative/zero price, negative/zero quantity, duplicate items, very large values\n\n2. **`remove_item(name)`**\n   - Removes item by name\n   - Edge cases: non-existent item, empty cart, case sensitivity\n\n3. **`get_subtotal()`**\n   - Returns sum of (price Ă— quantity) for all items\n   - Edge cases: empty cart, single item, multiple items\n\n4. **`apply_discount(subtotal, discount)`**\n   - Applies discount to subtotal\n   - Edge cases: zero discount, 100% discount, discount > subtotal, negative discount\n\n5. **`calculate_shipping(discounted_subtotal)`**\n   - Returns shipping cost based on threshold\n   - Edge cases: exactly at threshold, just below, just above, zero subtotal\n\n6. **`calculate_tax(amount)`**\n   - Calculates tax on given amount\n   - Edge cases: zero amount, negative amount, large amounts\n\n7. **`calculate_total(discount=0.0)`**\n   - Orchestrates full calculation: subtotal â†’ discount â†’ shipping â†’ tax\n   - Edge cases: empty cart, with/without discount, free shipping scenarios\n\n8. **`total_items()`**\n   - Returns total quantity of all items\n   - Edge cases: empty cart, single item, multiple items with various quantities\n\n9. **`clear_order()`**\n   - Removes all items\n   - Edge cases: already empty cart, cart with items\n\n10. **`list_items()`**\n    - Returns list of item names\n    - Edge cases: empty cart, single item, multiple items, order of items\n\n11. **`is_empty()`**\n    - Returns boolean indicating if cart is empty\n    - Edge cases: empty cart, cart with items\n\n### Key Testing Scenarios\n\n1. **Initialization variations**: Custom tax rates, thresholds, shipping costs\n2. **Item management flow**: Add â†’ verify â†’ remove â†’ verify\n3. **Calculation accuracy**: Verify mathematical correctness\n4. **Threshold boundaries**: Free shipping at exactly 100.0\n5. **Discount edge cases**: 0%, 50%, 100%, >100%\n6. **Invalid inputs**: Negative values, wrong types, empty strings\n7. **State management**: Cart state after operations\n8. **Integration scenarios**: Full order workflow\n\n### Potential Exception Scenarios\n- Adding item with invalid price/quantity\n- Removing non-existent item\n- Invalid discount values\n- Negative amounts in calculations\n\nI'm now ready to generate the test code in the next step.",
        "response_time": 0
      },
      {
        "step": 2,
        "prompt": "Based on the class above, list all relevant unit test scenarios you would create.\nEach scenario should describe:\n- the method being tested,\n- the type of case (e.g. normal use, invalid input, exception),\n- a short explanation of the intent.\nList as many scenarios as you can think of, covering all aspects of the class.\nDo not write test code yet.\n\n",
        "response": "## Unit Test Scenarios for OrderCalculator\n\n### Constructor (`__init__`)\n\n1. **Default initialization** (normal use) - Verify default values for tax_rate (0.23), free_shipping_threshold (100.0), and shipping_cost (10.0) are set correctly\n2. **Custom tax rate** (normal use) - Initialize with custom tax rate and verify it's applied\n3. **Custom shipping threshold** (normal use) - Initialize with custom free_shipping_threshold\n4. **Custom shipping cost** (normal use) - Initialize with custom shipping_cost\n5. **All custom parameters** (normal use) - Initialize with all custom values\n6. **Zero tax rate** (edge case) - Initialize with tax_rate=0\n7. **Zero shipping threshold** (edge case) - All orders get free shipping\n8. **Zero shipping cost** (edge case) - Shipping is always free\n9. **Negative tax rate** (invalid input) - Should raise exception or handle gracefully\n10. **Negative shipping threshold** (invalid input) - Should raise exception or handle gracefully\n11. **Negative shipping cost** (invalid input) - Should raise exception or handle gracefully\n\n### `add_item`\n\n12. **Add single item with default quantity** (normal use) - Add one item, verify it's in cart\n13. **Add single item with explicit quantity** (normal use) - Add item with quantity > 1\n14. **Add multiple different items** (normal use) - Add several items, verify all present\n15. **Add item with same name twice** (edge case) - Should update quantity or add separate entry\n16. **Add item with price zero** (edge case) - Free item handling\n17. **Add item with quantity zero** (invalid input) - Should raise exception or ignore\n18. **Add item with negative price** (invalid input) - Should raise exception\n19. **Add item with negative quantity** (invalid input) - Should raise exception\n20. **Add item with empty name** (invalid input) - Should raise exception\n21. **Add item with very large price** (edge case) - Verify no overflow issues\n22. **Add item with very large quantity** (edge case) - Verify no overflow issues\n23. **Add item with float quantity** (invalid input) - Quantity should be integer\n24. **Add item with whitespace-only name** (invalid input) - Should raise exception\n\n### `remove_item`\n\n25. **Remove existing item** (normal use) - Remove item that exists, verify removed\n26. **Remove item from cart with multiple items** (normal use) - Other items remain\n27. **Remove non-existent item** (invalid input) - Should raise exception (e.g., KeyError)\n28. **Remove from empty cart** (invalid input) - Should raise exception\n29. **Remove item with case-different name** (edge case) - Test case sensitivity\n30. **Remove same item twice** (invalid input) - Second removal should fail\n\n### `get_subtotal`\n\n31. **Subtotal of empty cart** (edge case) - Should return 0.0\n32. **Subtotal with single item, quantity 1** (normal use) - Returns item price\n33. **Subtotal with single item, quantity > 1** (normal use) - Returns price Ă— quantity\n34. **Subtotal with multiple items** (normal use) - Returns sum of all (price Ă— quantity)\n35. **Subtotal with free items (price 0)** (edge case) - Should handle correctly\n36. **Subtotal precision with decimals** (edge case) - Verify floating point accuracy\n\n### `apply_discount`\n\n37. **Apply zero discount** (edge case) - Subtotal unchanged\n38. **Apply small discount** (normal use) - Verify correct reduction\n39. **Apply 50% discount** (normal use) - Subtotal halved\n40. **Apply discount equal to subtotal** (edge case) - Result should be 0\n41. **Apply discount greater than subtotal** (edge case) - Should return 0 or negative\n42. **Apply negative discount** (invalid input) - Should raise exception or add to subtotal\n43. **Apply discount to zero subtotal** (edge case) - Should return 0\n44. **Apply percentage vs absolute discount** (normal use) - Clarify discount type interpretation\n\n### `calculate_shipping`\n\n45. **Subtotal below threshold** (normal use) - Returns shipping_cost\n46. **Subtotal exactly at threshold** (edge case) - Should shipping be free or charged?\n47. **Subtotal above threshold** (normal use) - Returns 0 (free shipping)\n48. **Subtotal just below threshold (99.99)** (edge case) - Shipping charged\n49. **Subtotal just above threshold (100.01)** (edge case) - Free shipping\n50. **Zero subtotal** (edge case) - Shipping behavior for empty cart\n51. **Negative subtotal** (invalid input) - Should handle gracefully\n\n### `calculate_tax`\n\n52. **Tax on positive amount** (normal use) - Returns amount Ă— tax_rate\n53. **Tax on zero amount** (edge case) - Returns 0\n54. **Tax on negative amount** (invalid input) - Should handle or raise exception\n55. **Tax with default rate (23%)** (normal use) - Verify calculation\n56. **Tax with custom rate** (normal use) - Verify custom rate applied\n57. **Tax with zero rate** (edge case) - Returns 0\n58. **Tax precision with decimals** (edge case) - Verify floating point accuracy\n\n### `calculate_total`\n\n59. **Total with no discount, below shipping threshold** (normal use) - subtotal + shipping + tax\n60. **Total with no discount, above shipping threshold** (normal use) - subtotal + tax (free shipping)\n61. **Total with discount applied** (normal use) - Verify discount reduces total correctly\n62. **Total with 100% discount** (edge case) - Should only have shipping + tax or zero\n63. **Total on empty cart** (edge case) - Should return 0 or just shipping\n64. **Total with discount making subtotal below threshold** (edge case) - Shipping now charged\n65. **Total with free items only** (edge case) - Subtotal 0, may incur shipping\n66. **Total calculation order** (normal use) - Verify: subtotal â†’ discount â†’ shipping â†’ tax\n\n### `total_items`\n\n67. **Total items in empty cart** (edge case) - Returns 0\n68. **Total items with single item, quantity 1** (normal use) - Returns 1\n69. **Total items with single item, quantity > 1** (normal use) - Returns quantity\n70. **Total items with multiple items** (normal use) - Returns sum of all quantities\n71. **Total items after adding and removing** (normal use) - Verify accurate count\n\n### `clear_order`\n\n72. **Clear cart with items** (normal use) - Cart becomes empty\n73. **Clear already empty cart** (edge case) - Should not raise error\n74. **Verify items removed after clear** (normal use) - list_items returns empty\n75. **Verify subtotal zero after clear** (normal use) - get_subtotal returns 0\n\n### `list_items`\n\n76. **List items in empty cart** (edge case) - Returns empty list\n77. **List items with single item** (normal use) - Returns list with one name\n78. **List items with multiple items** (normal use) - Returns all item names\n79. **List items returns names only** (normal use) - Not prices or quantities\n80. **List items order** (edge case) - Verify order (insertion order or sorted?)\n\n### `is_empty`\n\n81. **Is empty on new cart** (normal use) - Returns True\n82. **Is empty after adding item** (normal use) - Returns False\n83. **Is empty after adding and removing all items** (normal use) - Returns True\n84. **Is empty after clear_order** (normal use) - Returns True\n\n### Integration/Workflow Scenarios\n\n85. **Full order workflow** (integration) - Add items â†’ apply discount â†’ calculate total â†’ clear\n86. **Add item, get subtotal, remove item, verify subtotal** (integration) - State consistency\n87. **Multiple discounts in sequence** (integration) - If supported\n88. **Recalculate total after modifying cart** (integration) - Total reflects changes\n89. **Cart state isolation** (integration) - Multiple OrderCalculator instances don't interfere",
        "response_time": 0
      },
      {
        "step": 3,
        "prompt": "Now, based on the test scenarios you just listed, generate the complete Python unit test suite using the `unittest` framework.\n\nFollow these rules:\n- Include one test method per scenario.\n- Use meaningful test method names.\n- Do not include comments or explanations.\n- Output a valid `.py` file containing only the test class.\n- IMPORTANT: Do NOT copy or redefine the OrderCalculator class in your test file. The class already exists in a separate module. Simply import it using: `from order_calculator import OrderCalculator`\n\nThe output must contain only Python code.",
        "response": "```python\nimport unittest\nfrom order_calculator import OrderCalculator\n\n\nclass TestOrderCalculatorInit(unittest.TestCase):\n    def test_default_initialization(self):\n        calc = OrderCalculator()\n        self.assertEqual(calc.tax_rate, 0.23)\n        self.assertEqual(calc.free_shipping_threshold, 100.0)\n        self.assertEqual(calc.shipping_cost, 10.0)\n\n    def test_custom_tax_rate(self):\n        calc = OrderCalculator(tax_rate=0.10)\n        self.assertEqual(calc.tax_rate, 0.10)\n\n    def test_custom_shipping_threshold(self):\n        calc = OrderCalculator(free_shipping_threshold=50.0)\n        self.assertEqual(calc.free_shipping_threshold, 50.0)\n\n    def test_custom_shipping_cost(self):\n        calc = OrderCalculator(shipping_cost=15.0)\n        self.assertEqual(calc.shipping_cost, 15.0)\n\n    def test_all_custom_parameters(self):\n        calc = OrderCalculator(tax_rate=0.15, free_shipping_threshold=200.0, shipping_cost=20.0)\n        self.assertEqual(calc.tax_rate, 0.15)\n        self.assertEqual(calc.free_shipping_threshold, 200.0)\n        self.assertEqual(calc.shipping_cost, 20.0)\n\n    def test_zero_tax_rate(self):\n        calc = OrderCalculator(tax_rate=0)\n        self.assertEqual(calc.tax_rate, 0)\n\n    def test_zero_shipping_threshold(self):\n        calc = OrderCalculator(free_shipping_threshold=0)\n        self.assertEqual(calc.free_shipping_threshold, 0)\n\n    def test_zero_shipping_cost(self):\n        calc = OrderCalculator(shipping_cost=0)\n        self.assertEqual(calc.shipping_cost, 0)\n\n    def test_negative_tax_rate(self):\n        with self.assertRaises(ValueError):\n            OrderCalculator(tax_rate=-0.1)\n\n    def test_negative_shipping_threshold(self):\n        with self.assertRaises(ValueError):\n            OrderCalculator(free_shipping_threshold=-10.0)\n\n    def test_negative_shipping_cost(self):\n        with self.assertRaises(ValueError):\n            OrderCalculator(shipping_cost=-5.0)\n\n\nclass TestAddItem(unittest.TestCase):\n    def setUp(self):\n        self.calc = OrderCalculator()\n\n    def test_add_single_item_default_quantity(self):\n        self.calc.add_item(\"Apple\", 1.50)\n        self.assertIn(\"Apple\", self.calc.list_items())\n\n    def test_add_single_item_explicit_quantity(self):\n        self.calc.add_item(\"Apple\", 1.50, 3)\n        self.assertEqual(self.calc.total_items(), 3)\n\n    def test_add_multiple_different_items(self):\n        self.calc.add_item(\"Apple\", 1.50)\n        self.calc.add_item(\"Banana\", 2.00)\n        self.calc.add_item(\"Orange\", 3.00)\n        self.assertEqual(len(self.calc.list_items()), 3)\n\n    def test_add_item_same_name_twice(self):\n        self.calc.add_item(\"Apple\", 1.50, 2)\n        self.calc.add_item(\"Apple\", 1.50, 3)\n        self.assertEqual(self.calc.total_items(), 5)\n\n    def test_add_item_with_price_zero(self):\n        self.calc.add_item(\"FreeItem\", 0.0)\n        self.assertIn(\"FreeItem\", self.calc.list_items())\n\n    def test_add_item_with_quantity_zero(self):\n        with self.assertRaises(ValueError):\n            self.calc.add_item(\"Apple\", 1.50, 0)\n\n    def test_add_item_with_negative_price(self):\n        with self.assertRaises(ValueError):\n            self.calc.add_item(\"Apple\", -1.50)\n\n    def test_add_item_with_negative_quantity(self):\n        with self.assertRaises(ValueError):\n            self.calc.add_item(\"Apple\", 1.50, -1)\n\n    def test_add_item_with_empty_name(self):\n        with self.assertRaises(ValueError):\n            self.calc.add_item(\"\", 1.50)\n\n    def test_add_item_with_very_large_price(self):\n        self.calc.add_item(\"Expensive\", 1000000.0)\n        self.assertEqual(self.calc.get_subtotal(), 1000000.0)\n\n    def test_add_item_with_very_large_quantity(self):\n        self.calc.add_item(\"Bulk\", 1.0, 1000000)\n        self.assertEqual(self.calc.total_items(), 1000000)\n\n    def test_add_item_with_whitespace_only_name(self):\n        with self.assertRaises(ValueError):\n            self.calc.add_item(\"   \", 1.50)\n\n\nclass TestRemoveItem(unittest.TestCase):\n    def setUp(self):\n        self.calc = OrderCalculator()\n\n    def test_remove_existing_item(self):\n        self.calc.add_item(\"Apple\", 1.50)\n        self.calc.remove_item(\"Apple\")\n        self.assertNotIn(\"Apple\", self.calc.list_items())\n\n    def test_remove_item_from_cart_with_multiple_items(self):\n        self.calc.add_item(\"Apple\", 1.50)\n        self.calc.add_item(\"Banana\", 2.00)\n        self.calc.remove_item(\"Apple\")\n        self.assertNotIn(\"Apple\", self.calc.list_items())\n        self.assertIn(\"Banana\", self.calc.list_items())\n\n    def test_remove_non_existent_item(self):\n        self.calc.add_item(\"Apple\", 1.50)\n        with self.assertRaises(KeyError):\n            self.calc.remove_item(\"Banana\")\n\n    def test_remove_from_empty_cart(self):\n        with self.assertRaises(KeyError):\n            self.calc.remove_item(\"Apple\")\n\n    def test_remove_same_item_twice(self):\n        self.calc.add_item(\"Apple\", 1.50)\n        self.calc.remove_item(\"Apple\")\n        with self.assertRaises(KeyError):\n            self.calc.remove_item(\"Apple\")\n\n\nclass TestGetSubtotal(unittest.TestCase):\n    def setUp(self):\n        self.calc = OrderCalculator()\n\n    def test_subtotal_of_empty_cart(self):\n        self.assertEqual(self.calc.get_subtotal(), 0.0)\n\n    def test_subtotal_with_single_item_quantity_one(self):\n        self.calc.add_item(\"Apple\", 1.50)\n        self.assertEqual(self.calc.get_subtotal(), 1.50)\n\n    def test_subtotal_with_single_item_quantity_greater_than_one(self):\n        self.calc.add_item(\"Apple\", 1.50, 3)\n        self.assertEqual(self.calc.get_subtotal(), 4.50)\n\n    def test_subtotal_with_multiple_items(self):\n        self.calc.add_item(\"Apple\", 1.50, 2)\n        self.calc.add_item(\"Banana\", 2.00, 3)\n        self.assertEqual(self.calc.get_subtotal(), 9.0)\n\n    def test_subtotal_with_free_items(self):\n        self.calc.add_item(\"FreeItem\", 0.0, 5)\n        self.assertEqual(self.calc.get_subtotal(), 0.0)\n\n    def test_subtotal_precision_with_decimals(self):\n        self.calc.add_item(\"Item1\", 0.1, 3)\n        self.assertAlmostEqual(self.calc.get_subtotal(), 0.3, places=2)\n\n\nclass TestApplyDiscount(unittest.TestCase):\n    def setUp(self):\n        self.calc = OrderCalculator()\n\n    def test_apply_zero_discount(self):\n        result = self.calc.apply_discount(100.0, 0.0)\n        self.assertEqual(result, 100.0)\n\n    def test_apply_small_discount(self):\n        result = self.calc.apply_discount(100.0, 10.0)\n        self.assertEqual(result, 90.0)\n\n    def test_apply_fifty_percent_discount(self):\n        result = self.calc.apply_discount(100.0, 50.0)\n        self.assertEqual(result, 50.0)\n\n    def test_apply_discount_equal_to_subtotal(self):\n        result = self.calc.apply_discount(100.0, 100.0)\n        self.assertEqual(result, 0.0)\n\n    def test_apply_discount_greater_than_subtotal(self):\n        result = self.calc.apply_discount(100.0, 150.0)\n        self.assertEqual(result, 0.0)\n\n    def test_apply_negative_discount(self):\n        with self.assertRaises(ValueError):\n            self.calc.apply_discount(100.0, -10.0)\n\n    def test_apply_discount_to_zero_subtotal(self):\n        result = self.calc.apply_discount(0.0, 10.0)\n        self.assertEqual(result, 0.0)\n\n\nclass TestCalculateShipping(unittest.TestCase):\n    def setUp(self):\n        self.calc = OrderCalculator()\n\n    def test_subtotal_below_threshold(self):\n        result = self.calc.calculate_shipping(50.0)\n        self.assertEqual(result, 10.0)\n\n    def test_subtotal_exactly_at_threshold(self):\n        result = self.calc.calculate_shipping(100.0)\n        self.assertEqual(result, 0.0)\n\n    def test_subtotal_above_threshold(self):\n        result = self.calc.calculate_shipping(150.0)\n        self.assertEqual(result, 0.0)\n\n    def test_subtotal_just_below_threshold(self):\n        result = self.calc.calculate_shipping(99.99)\n        self.assertEqual(result, 10.0)\n\n    def test_subtotal_just_above_threshold(self):\n        result = self.calc.calculate_shipping(100.01)\n        self.assertEqual(result, 0.0)\n\n    def test_zero_subtotal(self):\n        result = self.calc.calculate_shipping(0.0)\n        self.assertEqual(result, 10.0)\n\n\nclass TestCalculateTax(unittest.TestCase):\n    def setUp(self):\n        self.calc = OrderCalculator()\n\n    def test_tax_on_positive_amount(self):\n        result = self.calc.calculate_tax(100.0)\n        self.assertEqual(result, 23.0)\n\n    def test_tax_on_zero_amount(self):\n        result = self.calc.calculate_tax(0.0)\n        self.assertEqual(result, 0.0)\n\n    def test_tax_with_default_rate(self):\n        result = self.calc.calculate_tax(200.0)\n        self.assertEqual(result, 46.0)\n\n    def test_tax_with_custom_rate(self):\n        calc = OrderCalculator(tax_rate=0.10)\n        result = calc.calculate_tax(100.0)\n        self.assertEqual(result, 10.0)\n\n    def test_tax_with_zero_rate(self):\n        calc = OrderCalculator(tax_rate=0)\n        result = calc.calculate_tax(100.0)\n        self.assertEqual(result, 0.0)\n\n    def test_tax_precision_with_decimals(self):\n        result = self.calc.calculate_tax(33.33)\n        self.assertAlmostEqual(result, 7.6659, places=2)\n\n\nclass TestCalculateTotal(unittest.TestCase):\n    def setUp(self):\n        self.calc = OrderCalculator()\n\n    def test_total_no_discount_below_shipping_threshold(self):\n        self.calc.add_item(\"Item\", 50.0)\n        total = self.calc.calculate_total()\n        expected = (50.0 + 10.0) * 1.23\n        self.assertAlmostEqual(total, expected, places=2)\n\n    def test_total_no_discount_above_shipping_threshold(self):\n        self.calc.add_item(\"Item\", 150.0)\n        total = self.calc.calculate_total()\n        expected = 150.0 * 1.23\n        self.assertAlmostEqual(total, expected, places=2)\n\n    def test_total_with_discount_applied(self):\n        self.calc.add_item(\"Item\", 200.0)\n        total = self.calc.calculate_total(discount=50.0)\n        expected = 150.0 * 1.23\n        self.assertAlmostEqual(total, expected, places=2)\n\n    def test_total_with_100_percent_discount(self):\n        self.calc.add_item(\"Item\", 100.0)\n        total = self.calc.calculate_total(discount=100.0)\n        expected = 10.0 * 1.23\n        self.assertAlmostEqual(total, expected, places=2)\n\n    def test_total_on_empty_cart(self):\n        total = self.calc.calculate_total()\n        expected = 10.0 * 1.23\n        self.assertAlmostEqual(total, expected, places=2)\n\n    def test_total_with_discount_making_subtotal_below_threshold(self):\n        self.calc.add_item(\"Item\", 120.0)\n        total = self.calc.calculate_total(discount=50.0)\n        expected = (70.0 + 10.0) * 1.23\n        self.assertAlmostEqual(total, expected, places=2)\n\n    def test_total_with_free_items_only(self):\n        self.calc.add_item(\"FreeItem\", 0.0, 5)\n        total = self.calc.calculate_total()\n        expected = 10.0 * 1.23\n        self.assertAlmostEqual(total, expected, places=2)\n\n\nclass TestTotalItems(unittest.TestCase):\n    def setUp(self):\n        self.calc = OrderCalculator()\n\n    def test_total_items_empty_cart(self):\n        self.assertEqual(self.calc.total_items(), 0)\n\n    def test_total_items_single_item_quantity_one(self):\n        self.calc.add_item(\"Apple\", 1.50)\n        self.assertEqual(self.calc.total_items(), 1)\n\n    def test_total_items_single_item_quantity_greater_than_one(self):\n        self.calc.add_item(\"Apple\", 1.50, 5)\n        self.assertEqual(self.calc.total_items(), 5)\n\n    def test_total_items_multiple_items(self):\n        self.calc.add_item(\"Apple\", 1.50, 2)\n        self.calc.add_item(\"Banana\", 2.00, 3)\n        self.assertEqual(self.calc.total_items(), 5)\n\n    def test_total_items_after_adding_and_removing(self):\n        self.calc.add_item(\"Apple\", 1.50, 2)\n        self.calc.add_item(\"Banana\", 2.00, 3)\n        self.calc.remove_item(\"Apple\")\n        self.assertEqual(self.calc.total_items(), 3)\n\n\nclass TestClearOrder(unittest.TestCase):\n    def setUp(self):\n        self.calc = OrderCalculator()\n\n    def test_clear_cart_with_items(self):\n        self.calc.add_item(\"Apple\", 1.50)\n        self.calc.add_item(\"Banana\", 2.00)\n        self.calc.clear_order()\n        self.assertTrue(self.calc.is_empty())\n\n    def test_clear_already_empty_cart(self):\n        self.calc.clear_order()\n        self.assertTrue(self.calc.is_empty())\n\n    def test_list_items_empty_after_clear(self):\n        self.calc.add_item(\"Apple\", 1.50)\n        self.calc.clear_order()\n        self.assertEqual(self.calc.list_items(), [])\n\n    def test_subtotal_zero_after_clear(self):\n        self.calc.add_item(\"Apple\", 1.50)\n        self.calc.clear_order()\n        self.assertEqual(self.calc.get_subtotal(), 0.0)\n\n\nclass TestListItems(unittest.TestCase):\n    def setUp(self):\n        self.calc = OrderCalculator()\n\n    def test_list_items_empty_cart(self):\n        self.assertEqual(self.calc.list_items(), [])\n\n    def test_list_items_single_item(self):\n        self.calc.add_item(\"Apple\", 1.50)\n        self.assertEqual(self.calc.list_items(), [\"Apple\"])\n\n    def test_list_items_multiple_items(self):\n        self.calc.add_item(\"Apple\", 1.50)\n        self.calc.add_item(\"Banana\", 2.00)\n        items = self.calc.list_items()\n        self.assertIn(\"Apple\", items)\n        self.assertIn(\"Banana\", items)\n        self.assertEqual(len(items), 2)\n\n    def test_list_items_returns_names_only(self):\n        self.calc.add_item(\"Apple\", 1.50, 3)\n        items = self.calc.list_items()\n        self.assertEqual(items, [\"Apple\"])\n\n\nclass TestIsEmpty(unittest.TestCase):\n    def setUp(self):\n        self.calc = OrderCalculator()\n\n    def test_is_empty_on_new_cart(self):\n        self.assertTrue(self.calc.is_empty())\n\n    def test_is_empty_after_adding_item(self):\n        self.calc.add_item(\"Apple\", 1.50)\n        self.assertFalse(self.calc.is_empty())\n\n    def test_is_empty_after_adding_and_removing_all_items(self):\n        self.calc.add_item(\"Apple\", 1.50)\n        self.calc.remove_item(\"Apple\")\n        self.assertTrue(self.calc.is_empty())\n\n    def test_is_empty_after_clear_order(self):\n        self.calc.add_item(\"Apple\", 1.50)\n        self.calc.clear_order()\n        self.assertTrue(self.calc.is_empty())\n\n\nclass TestIntegration(unittest.TestCase):\n    def test_full_order_workflow(self):\n        calc = OrderCalculator()\n        calc.add_item(\"Laptop\", 500.0)\n        calc.add_item(\"Mouse\", 25.0, 2)\n        self.assertEqual(calc.total_items(), 3)\n        self.assertEqual(calc.get_subtotal(), 550.0)\n        total = calc.calculate_total(discount=50.0)\n        expected = 500.0 * 1.23\n        self.assertAlmostEqual(total, expected, places=2)\n        calc.clear_order()\n        self.assertTrue(calc.is_empty())\n\n    def test_add_get_subtotal_remove_verify_subtotal(self):\n        calc = OrderCalculator()\n        calc.add_item(\"Apple\", 10.0, 2)\n        self.assertEqual(calc.get_subtotal(), 20.0)\n        calc.add_item(\"Banana\", 5.0, 3)\n        self.assertEqual(calc.get_subtotal(), 35.0)\n        calc.remove_item(\"Apple\")\n        self.assertEqual(calc.get_subtotal(), 15.0)\n\n    def test_recalculate_total_after_modifying_cart(self):\n        calc = OrderCalculator()\n        calc.add_item(\"Item\", 80.0)\n        total1 = calc.calculate_total()\n        calc.add_item(\"Extra\", 30.0)\n        total2 = calc.calculate_total()\n        self.assertNotEqual(total1, total2)\n        self.assertGreater(total2, total1)\n\n    def test_cart_state_isolation(self):\n        calc1 = OrderCalculator()\n        calc2 = OrderCalculator()\n        calc1.add_item(\"Apple\", 10.0)\n        self.assertEqual(calc1.total_items(), 1)\n        self.assertEqual(calc2.total_items(), 0)\n\n\nif __name__ == \"__main__\":\n    unittest.main()\n```",
        "response_time": 0
      }
    ],
    "final_response": "```python\nimport unittest\nfrom order_calculator import OrderCalculator\n\n\nclass TestOrderCalculatorInit(unittest.TestCase):\n    def test_default_initialization(self):\n        calc = OrderCalculator()\n        self.assertEqual(calc.tax_rate, 0.23)\n        self.assertEqual(calc.free_shipping_threshold, 100.0)\n        self.assertEqual(calc.shipping_cost, 10.0)\n\n    def test_custom_tax_rate(self):\n        calc = OrderCalculator(tax_rate=0.10)\n        self.assertEqual(calc.tax_rate, 0.10)\n\n    def test_custom_shipping_threshold(self):\n        calc = OrderCalculator(free_shipping_threshold=50.0)\n        self.assertEqual(calc.free_shipping_threshold, 50.0)\n\n    def test_custom_shipping_cost(self):\n        calc = OrderCalculator(shipping_cost=15.0)\n        self.assertEqual(calc.shipping_cost, 15.0)\n\n    def test_all_custom_parameters(self):\n        calc = OrderCalculator(tax_rate=0.15, free_shipping_threshold=200.0, shipping_cost=20.0)\n        self.assertEqual(calc.tax_rate, 0.15)\n        self.assertEqual(calc.free_shipping_threshold, 200.0)\n        self.assertEqual(calc.shipping_cost, 20.0)\n\n    def test_zero_tax_rate(self):\n        calc = OrderCalculator(tax_rate=0)\n        self.assertEqual(calc.tax_rate, 0)\n\n    def test_zero_shipping_threshold(self):\n        calc = OrderCalculator(free_shipping_threshold=0)\n        self.assertEqual(calc.free_shipping_threshold, 0)\n\n    def test_zero_shipping_cost(self):\n        calc = OrderCalculator(shipping_cost=0)\n        self.assertEqual(calc.shipping_cost, 0)\n\n    def test_negative_tax_rate(self):\n        with self.assertRaises(ValueError):\n            OrderCalculator(tax_rate=-0.1)\n\n    def test_negative_shipping_threshold(self):\n        with self.assertRaises(ValueError):\n            OrderCalculator(free_shipping_threshold=-10.0)\n\n    def test_negative_shipping_cost(self):\n        with self.assertRaises(ValueError):\n            OrderCalculator(shipping_cost=-5.0)\n\n\nclass TestAddItem(unittest.TestCase):\n    def setUp(self):\n        self.calc = OrderCalculator()\n\n    def test_add_single_item_default_quantity(self):\n        self.calc.add_item(\"Apple\", 1.50)\n        self.assertIn(\"Apple\", self.calc.list_items())\n\n    def test_add_single_item_explicit_quantity(self):\n        self.calc.add_item(\"Apple\", 1.50, 3)\n        self.assertEqual(self.calc.total_items(), 3)\n\n    def test_add_multiple_different_items(self):\n        self.calc.add_item(\"Apple\", 1.50)\n        self.calc.add_item(\"Banana\", 2.00)\n        self.calc.add_item(\"Orange\", 3.00)\n        self.assertEqual(len(self.calc.list_items()), 3)\n\n    def test_add_item_same_name_twice(self):\n        self.calc.add_item(\"Apple\", 1.50, 2)\n        self.calc.add_item(\"Apple\", 1.50, 3)\n        self.assertEqual(self.calc.total_items(), 5)\n\n    def test_add_item_with_price_zero(self):\n        self.calc.add_item(\"FreeItem\", 0.0)\n        self.assertIn(\"FreeItem\", self.calc.list_items())\n\n    def test_add_item_with_quantity_zero(self):\n        with self.assertRaises(ValueError):\n            self.calc.add_item(\"Apple\", 1.50, 0)\n\n    def test_add_item_with_negative_price(self):\n        with self.assertRaises(ValueError):\n            self.calc.add_item(\"Apple\", -1.50)\n\n    def test_add_item_with_negative_quantity(self):\n        with self.assertRaises(ValueError):\n            self.calc.add_item(\"Apple\", 1.50, -1)\n\n    def test_add_item_with_empty_name(self):\n        with self.assertRaises(ValueError):\n            self.calc.add_item(\"\", 1.50)\n\n    def test_add_item_with_very_large_price(self):\n        self.calc.add_item(\"Expensive\", 1000000.0)\n        self.assertEqual(self.calc.get_subtotal(), 1000000.0)\n\n    def test_add_item_with_very_large_quantity(self):\n        self.calc.add_item(\"Bulk\", 1.0, 1000000)\n        self.assertEqual(self.calc.total_items(), 1000000)\n\n    def test_add_item_with_whitespace_only_name(self):\n        with self.assertRaises(ValueError):\n            self.calc.add_item(\"   \", 1.50)\n\n\nclass TestRemoveItem(unittest.TestCase):\n    def setUp(self):\n        self.calc = OrderCalculator()\n\n    def test_remove_existing_item(self):\n        self.calc.add_item(\"Apple\", 1.50)\n        self.calc.remove_item(\"Apple\")\n        self.assertNotIn(\"Apple\", self.calc.list_items())\n\n    def test_remove_item_from_cart_with_multiple_items(self):\n        self.calc.add_item(\"Apple\", 1.50)\n        self.calc.add_item(\"Banana\", 2.00)\n        self.calc.remove_item(\"Apple\")\n        self.assertNotIn(\"Apple\", self.calc.list_items())\n        self.assertIn(\"Banana\", self.calc.list_items())\n\n    def test_remove_non_existent_item(self):\n        self.calc.add_item(\"Apple\", 1.50)\n        with self.assertRaises(KeyError):\n            self.calc.remove_item(\"Banana\")\n\n    def test_remove_from_empty_cart(self):\n        with self.assertRaises(KeyError):\n            self.calc.remove_item(\"Apple\")\n\n    def test_remove_same_item_twice(self):\n        self.calc.add_item(\"Apple\", 1.50)\n        self.calc.remove_item(\"Apple\")\n        with self.assertRaises(KeyError):\n            self.calc.remove_item(\"Apple\")\n\n\nclass TestGetSubtotal(unittest.TestCase):\n    def setUp(self):\n        self.calc = OrderCalculator()\n\n    def test_subtotal_of_empty_cart(self):\n        self.assertEqual(self.calc.get_subtotal(), 0.0)\n\n    def test_subtotal_with_single_item_quantity_one(self):\n        self.calc.add_item(\"Apple\", 1.50)\n        self.assertEqual(self.calc.get_subtotal(), 1.50)\n\n    def test_subtotal_with_single_item_quantity_greater_than_one(self):\n        self.calc.add_item(\"Apple\", 1.50, 3)\n        self.assertEqual(self.calc.get_subtotal(), 4.50)\n\n    def test_subtotal_with_multiple_items(self):\n        self.calc.add_item(\"Apple\", 1.50, 2)\n        self.calc.add_item(\"Banana\", 2.00, 3)\n        self.assertEqual(self.calc.get_subtotal(), 9.0)\n\n    def test_subtotal_with_free_items(self):\n        self.calc.add_item(\"FreeItem\", 0.0, 5)\n        self.assertEqual(self.calc.get_subtotal(), 0.0)\n\n    def test_subtotal_precision_with_decimals(self):\n        self.calc.add_item(\"Item1\", 0.1, 3)\n        self.assertAlmostEqual(self.calc.get_subtotal(), 0.3, places=2)\n\n\nclass TestApplyDiscount(unittest.TestCase):\n    def setUp(self):\n        self.calc = OrderCalculator()\n\n    def test_apply_zero_discount(self):\n        result = self.calc.apply_discount(100.0, 0.0)\n        self.assertEqual(result, 100.0)\n\n    def test_apply_small_discount(self):\n        result = self.calc.apply_discount(100.0, 10.0)\n        self.assertEqual(result, 90.0)\n\n    def test_apply_fifty_percent_discount(self):\n        result = self.calc.apply_discount(100.0, 50.0)\n        self.assertEqual(result, 50.0)\n\n    def test_apply_discount_equal_to_subtotal(self):\n        result = self.calc.apply_discount(100.0, 100.0)\n        self.assertEqual(result, 0.0)\n\n    def test_apply_discount_greater_than_subtotal(self):\n        result = self.calc.apply_discount(100.0, 150.0)\n        self.assertEqual(result, 0.0)\n\n    def test_apply_negative_discount(self):\n        with self.assertRaises(ValueError):\n            self.calc.apply_discount(100.0, -10.0)\n\n    def test_apply_discount_to_zero_subtotal(self):\n        result = self.calc.apply_discount(0.0, 10.0)\n        self.assertEqual(result, 0.0)\n\n\nclass TestCalculateShipping(unittest.TestCase):\n    def setUp(self):\n        self.calc = OrderCalculator()\n\n    def test_subtotal_below_threshold(self):\n        result = self.calc.calculate_shipping(50.0)\n        self.assertEqual(result, 10.0)\n\n    def test_subtotal_exactly_at_threshold(self):\n        result = self.calc.calculate_shipping(100.0)\n        self.assertEqual(result, 0.0)\n\n    def test_subtotal_above_threshold(self):\n        result = self.calc.calculate_shipping(150.0)\n        self.assertEqual(result, 0.0)\n\n    def test_subtotal_just_below_threshold(self):\n        result = self.calc.calculate_shipping(99.99)\n        self.assertEqual(result, 10.0)\n\n    def test_subtotal_just_above_threshold(self):\n        result = self.calc.calculate_shipping(100.01)\n        self.assertEqual(result, 0.0)\n\n    def test_zero_subtotal(self):\n        result = self.calc.calculate_shipping(0.0)\n        self.assertEqual(result, 10.0)\n\n\nclass TestCalculateTax(unittest.TestCase):\n    def setUp(self):\n        self.calc = OrderCalculator()\n\n    def test_tax_on_positive_amount(self):\n        result = self.calc.calculate_tax(100.0)\n        self.assertEqual(result, 23.0)\n\n    def test_tax_on_zero_amount(self):\n        result = self.calc.calculate_tax(0.0)\n        self.assertEqual(result, 0.0)\n\n    def test_tax_with_default_rate(self):\n        result = self.calc.calculate_tax(200.0)\n        self.assertEqual(result, 46.0)\n\n    def test_tax_with_custom_rate(self):\n        calc = OrderCalculator(tax_rate=0.10)\n        result = calc.calculate_tax(100.0)\n        self.assertEqual(result, 10.0)\n\n    def test_tax_with_zero_rate(self):\n        calc = OrderCalculator(tax_rate=0)\n        result = calc.calculate_tax(100.0)\n        self.assertEqual(result, 0.0)\n\n    def test_tax_precision_with_decimals(self):\n        result = self.calc.calculate_tax(33.33)\n        self.assertAlmostEqual(result, 7.6659, places=2)\n\n\nclass TestCalculateTotal(unittest.TestCase):\n    def setUp(self):\n        self.calc = OrderCalculator()\n\n    def test_total_no_discount_below_shipping_threshold(self):\n        self.calc.add_item(\"Item\", 50.0)\n        total = self.calc.calculate_total()\n        expected = (50.0 + 10.0) * 1.23\n        self.assertAlmostEqual(total, expected, places=2)\n\n    def test_total_no_discount_above_shipping_threshold(self):\n        self.calc.add_item(\"Item\", 150.0)\n        total = self.calc.calculate_total()\n        expected = 150.0 * 1.23\n        self.assertAlmostEqual(total, expected, places=2)\n\n    def test_total_with_discount_applied(self):\n        self.calc.add_item(\"Item\", 200.0)\n        total = self.calc.calculate_total(discount=50.0)\n        expected = 150.0 * 1.23\n        self.assertAlmostEqual(total, expected, places=2)\n\n    def test_total_with_100_percent_discount(self):\n        self.calc.add_item(\"Item\", 100.0)\n        total = self.calc.calculate_total(discount=100.0)\n        expected = 10.0 * 1.23\n        self.assertAlmostEqual(total, expected, places=2)\n\n    def test_total_on_empty_cart(self):\n        total = self.calc.calculate_total()\n        expected = 10.0 * 1.23\n        self.assertAlmostEqual(total, expected, places=2)\n\n    def test_total_with_discount_making_subtotal_below_threshold(self):\n        self.calc.add_item(\"Item\", 120.0)\n        total = self.calc.calculate_total(discount=50.0)\n        expected = (70.0 + 10.0) * 1.23\n        self.assertAlmostEqual(total, expected, places=2)\n\n    def test_total_with_free_items_only(self):\n        self.calc.add_item(\"FreeItem\", 0.0, 5)\n        total = self.calc.calculate_total()\n        expected = 10.0 * 1.23\n        self.assertAlmostEqual(total, expected, places=2)\n\n\nclass TestTotalItems(unittest.TestCase):\n    def setUp(self):\n        self.calc = OrderCalculator()\n\n    def test_total_items_empty_cart(self):\n        self.assertEqual(self.calc.total_items(), 0)\n\n    def test_total_items_single_item_quantity_one(self):\n        self.calc.add_item(\"Apple\", 1.50)\n        self.assertEqual(self.calc.total_items(), 1)\n\n    def test_total_items_single_item_quantity_greater_than_one(self):\n        self.calc.add_item(\"Apple\", 1.50, 5)\n        self.assertEqual(self.calc.total_items(), 5)\n\n    def test_total_items_multiple_items(self):\n        self.calc.add_item(\"Apple\", 1.50, 2)\n        self.calc.add_item(\"Banana\", 2.00, 3)\n        self.assertEqual(self.calc.total_items(), 5)\n\n    def test_total_items_after_adding_and_removing(self):\n        self.calc.add_item(\"Apple\", 1.50, 2)\n        self.calc.add_item(\"Banana\", 2.00, 3)\n        self.calc.remove_item(\"Apple\")\n        self.assertEqual(self.calc.total_items(), 3)\n\n\nclass TestClearOrder(unittest.TestCase):\n    def setUp(self):\n        self.calc = OrderCalculator()\n\n    def test_clear_cart_with_items(self):\n        self.calc.add_item(\"Apple\", 1.50)\n        self.calc.add_item(\"Banana\", 2.00)\n        self.calc.clear_order()\n        self.assertTrue(self.calc.is_empty())\n\n    def test_clear_already_empty_cart(self):\n        self.calc.clear_order()\n        self.assertTrue(self.calc.is_empty())\n\n    def test_list_items_empty_after_clear(self):\n        self.calc.add_item(\"Apple\", 1.50)\n        self.calc.clear_order()\n        self.assertEqual(self.calc.list_items(), [])\n\n    def test_subtotal_zero_after_clear(self):\n        self.calc.add_item(\"Apple\", 1.50)\n        self.calc.clear_order()\n        self.assertEqual(self.calc.get_subtotal(), 0.0)\n\n\nclass TestListItems(unittest.TestCase):\n    def setUp(self):\n        self.calc = OrderCalculator()\n\n    def test_list_items_empty_cart(self):\n        self.assertEqual(self.calc.list_items(), [])\n\n    def test_list_items_single_item(self):\n        self.calc.add_item(\"Apple\", 1.50)\n        self.assertEqual(self.calc.list_items(), [\"Apple\"])\n\n    def test_list_items_multiple_items(self):\n        self.calc.add_item(\"Apple\", 1.50)\n        self.calc.add_item(\"Banana\", 2.00)\n        items = self.calc.list_items()\n        self.assertIn(\"Apple\", items)\n        self.assertIn(\"Banana\", items)\n        self.assertEqual(len(items), 2)\n\n    def test_list_items_returns_names_only(self):\n        self.calc.add_item(\"Apple\", 1.50, 3)\n        items = self.calc.list_items()\n        self.assertEqual(items, [\"Apple\"])\n\n\nclass TestIsEmpty(unittest.TestCase):\n    def setUp(self):\n        self.calc = OrderCalculator()\n\n    def test_is_empty_on_new_cart(self):\n        self.assertTrue(self.calc.is_empty())\n\n    def test_is_empty_after_adding_item(self):\n        self.calc.add_item(\"Apple\", 1.50)\n        self.assertFalse(self.calc.is_empty())\n\n    def test_is_empty_after_adding_and_removing_all_items(self):\n        self.calc.add_item(\"Apple\", 1.50)\n        self.calc.remove_item(\"Apple\")\n        self.assertTrue(self.calc.is_empty())\n\n    def test_is_empty_after_clear_order(self):\n        self.calc.add_item(\"Apple\", 1.50)\n        self.calc.clear_order()\n        self.assertTrue(self.calc.is_empty())\n\n\nclass TestIntegration(unittest.TestCase):\n    def test_full_order_workflow(self):\n        calc = OrderCalculator()\n        calc.add_item(\"Laptop\", 500.0)\n        calc.add_item(\"Mouse\", 25.0, 2)\n        self.assertEqual(calc.total_items(), 3)\n        self.assertEqual(calc.get_subtotal(), 550.0)\n        total = calc.calculate_total(discount=50.0)\n        expected = 500.0 * 1.23\n        self.assertAlmostEqual(total, expected, places=2)\n        calc.clear_order()\n        self.assertTrue(calc.is_empty())\n\n    def test_add_get_subtotal_remove_verify_subtotal(self):\n        calc = OrderCalculator()\n        calc.add_item(\"Apple\", 10.0, 2)\n        self.assertEqual(calc.get_subtotal(), 20.0)\n        calc.add_item(\"Banana\", 5.0, 3)\n        self.assertEqual(calc.get_subtotal(), 35.0)\n        calc.remove_item(\"Apple\")\n        self.assertEqual(calc.get_subtotal(), 15.0)\n\n    def test_recalculate_total_after_modifying_cart(self):\n        calc = OrderCalculator()\n        calc.add_item(\"Item\", 80.0)\n        total1 = calc.calculate_total()\n        calc.add_item(\"Extra\", 30.0)\n        total2 = calc.calculate_total()\n        self.assertNotEqual(total1, total2)\n        self.assertGreater(total2, total1)\n\n    def test_cart_state_isolation(self):\n        calc1 = OrderCalculator()\n        calc2 = OrderCalculator()\n        calc1.add_item(\"Apple\", 10.0)\n        self.assertEqual(calc1.total_items(), 1)\n        self.assertEqual(calc2.total_items(), 0)\n\n\nif __name__ == \"__main__\":\n    unittest.main()\n```",
    "total_response_time": 158.47605514526367,
    "strategy": "chain_of_thought_prompting",
    "context_type": "interface"
  }
}