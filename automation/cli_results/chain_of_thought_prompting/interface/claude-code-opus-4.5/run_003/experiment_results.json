{
  "model": "claude-code-opus-4.5",
  "strategy": "chain_of_thought_prompting",
  "context_type": "interface",
  "timestamp": "2025-12-30T02:33:59.666740",
  "response_time": 164.4903028011322,
  "test_file": "cli_results\\chain_of_thought_prompting\\interface\\claude-code-opus-4.5\\run_003\\tests.py",
  "raw_results": {
    "responses": [
      {
        "step": 1,
        "prompt": "You are a software testing assistant. Your task is to generate a set of unit tests for a Python class provided below.\n\nThe tests should:\n- use the `unittest` framework,\n- cover all public methods,\n- test typical usage as well as edge cases, invalid inputs, and exceptions,\n- be clear, atomic, and minimal.\n\nYou will now analyze the class to prepare relevant test cases.\nDo not write test code yet. Do not write test scenarios yet. Just analyze the class and prepare for the next step.\n\nBelow is the class interface (without implementation):\n\n```python\nfrom typing import TypedDict, List\n\nclass Item(TypedDict)\n\nclass OrderCalculator:\n    def __init__(self, tax_rate=0.23, free_shipping_threshold=100.0, shipping_cost=10.0):\n\ndef add_item(self, name: str, price: float, quantity: int = 1):\n\ndef remove_item(self, name: str):\n\ndef get_subtotal(self) -> float:\n\ndef apply_discount(self, subtotal: float, discount: float) -> float:\n\ndef calculate_shipping(self, discounted_subtotal: float) -> float:\n\ndef calculate_tax(self, amount: float) -> float:\n\ndef calculate_total(self, discount: float = 0.0) -> float:\n\ndef total_items(self) -> int:\n\ndef clear_order(self):\n\ndef list_items(self) -> List[str]:\n\ndef is_empty(self) -> bool:\n\n```\n\n",
        "response": "I'll analyze the `OrderCalculator` class to prepare for generating comprehensive unit tests.\n\n## Class Analysis\n\n### Constructor: `__init__(self, tax_rate=0.23, free_shipping_threshold=100.0, shipping_cost=10.0)`\n- **Parameters**: Three optional float parameters with defaults\n- **Test considerations**: Default values, custom values, edge cases (zero, negative values)\n\n### Public Methods:\n\n1. **`add_item(name: str, price: float, quantity: int = 1)`**\n   - Adds items to the order\n   - Test considerations: Valid items, duplicate names, zero/negative price, zero/negative quantity, non-string names\n\n2. **`remove_item(name: str)`**\n   - Removes an item by name\n   - Test considerations: Existing item, non-existing item, empty order, case sensitivity\n\n3. **`get_subtotal() -> float`**\n   - Returns sum of (price Ă— quantity) for all items\n   - Test considerations: Empty order, single item, multiple items, floating-point precision\n\n4. **`apply_discount(subtotal: float, discount: float) -> float`**\n   - Applies discount to subtotal\n   - Test considerations: Valid discount (0-100%), zero discount, 100% discount, negative discount, discount > 100%, negative subtotal\n\n5. **`calculate_shipping(discounted_subtotal: float) -> float`**\n   - Returns shipping cost or free shipping based on threshold\n   - Test considerations: Below threshold, at threshold, above threshold, zero subtotal, negative subtotal\n\n6. **`calculate_tax(amount: float) -> float`**\n   - Calculates tax on amount\n   - Test considerations: Positive amount, zero amount, negative amount, custom tax rate\n\n7. **`calculate_total(discount: float = 0.0) -> float`**\n   - Computes final total (subtotal - discount + shipping + tax)\n   - Test considerations: With/without discount, free shipping eligibility, empty order, integration of all components\n\n8. **`total_items() -> int`**\n   - Returns total count of items (sum of quantities)\n   - Test considerations: Empty order, single item, multiple items with varying quantities\n\n9. **`clear_order()`**\n   - Removes all items\n   - Test considerations: Clear empty order, clear order with items, verify state after clear\n\n10. **`list_items() -> List[str]`**\n    - Returns list of item names\n    - Test considerations: Empty order, order with items, order after modifications\n\n11. **`is_empty() -> bool`**\n    - Returns True if no items in order\n    - Test considerations: Empty order, non-empty order, after adding then removing all items\n\n### Key Testing Concerns:\n- **State management**: Order items collection integrity\n- **Boundary conditions**: Threshold values, zero values\n- **Error handling**: Invalid inputs, exceptions\n- **Calculations**: Floating-point precision, correct formulas\n- **Integration**: `calculate_total` combines multiple methods\n\nI'm ready to proceed with writing the test scenarios or test code.",
        "response_time": 0
      },
      {
        "step": 2,
        "prompt": "Based on the class above, list all relevant unit test scenarios you would create.\nEach scenario should describe:\n- the method being tested,\n- the type of case (e.g. normal use, invalid input, exception),\n- a short explanation of the intent.\nList as many scenarios as you can think of, covering all aspects of the class.\nDo not write test code yet.\n\n",
        "response": "## Unit Test Scenarios for OrderCalculator\n\n### Constructor (`__init__`)\n\n1. **Default parameters** (normal use) - Verify default tax_rate=0.23, free_shipping_threshold=100.0, shipping_cost=10.0 are set correctly\n2. **Custom parameters** (normal use) - Verify custom values are stored correctly\n3. **Zero tax rate** (edge case) - Tax rate of 0.0 should be valid\n4. **Zero shipping threshold** (edge case) - Threshold of 0.0 means always free shipping\n5. **Zero shipping cost** (edge case) - Shipping cost of 0.0 is valid\n6. **Negative tax rate** (invalid input) - Should raise exception or handle gracefully\n7. **Negative shipping threshold** (invalid input) - Should raise exception or handle gracefully\n8. **Negative shipping cost** (invalid input) - Should raise exception or handle gracefully\n\n### `add_item`\n\n9. **Add single item** (normal use) - Item added with correct name, price, quantity\n10. **Add item with default quantity** (normal use) - Quantity defaults to 1\n11. **Add item with custom quantity** (normal use) - Custom quantity is stored\n12. **Add multiple different items** (normal use) - All items stored separately\n13. **Add duplicate item name** (edge case) - Behavior when adding same name twice (update or error?)\n14. **Add item with zero price** (edge case) - Should this be allowed?\n15. **Add item with negative price** (invalid input) - Should raise exception\n16. **Add item with zero quantity** (edge case) - Should this be allowed or rejected?\n17. **Add item with negative quantity** (invalid input) - Should raise exception\n18. **Add item with empty name** (invalid input) - Should raise exception\n19. **Add item with non-string name** (invalid input) - Type validation\n20. **Add item with very large price** (edge case) - Handle large numbers\n21. **Add item with float quantity** (invalid input) - Quantity should be int\n\n### `remove_item`\n\n22. **Remove existing item** (normal use) - Item is removed, order updated\n23. **Remove non-existing item** (invalid input) - Should raise exception or return gracefully\n24. **Remove from empty order** (edge case) - Should raise exception or handle gracefully\n25. **Remove with case-sensitive name** (edge case) - \"Item\" vs \"item\" handling\n26. **Remove item and verify subtotal updates** (normal use) - Subtotal recalculated correctly\n27. **Remove one of multiple items** (normal use) - Other items remain\n\n### `get_subtotal`\n\n28. **Subtotal of empty order** (edge case) - Should return 0.0\n29. **Subtotal with single item** (normal use) - price Ä‚â€” quantity\n30. **Subtotal with multiple items** (normal use) - Sum of all (price Ä‚â€” quantity)\n31. **Subtotal with varying quantities** (normal use) - Correct multiplication\n32. **Subtotal floating-point precision** (edge case) - Handle decimal prices correctly\n\n### `apply_discount`\n\n33. **Apply zero discount** (edge case) - Returns original subtotal\n34. **Apply valid discount (e.g., 10%)** (normal use) - Correct percentage reduction\n35. **Apply 100% discount** (edge case) - Returns 0.0\n36. **Apply discount > 100%** (invalid input) - Should raise exception or cap\n37. **Apply negative discount** (invalid input) - Should raise exception\n38. **Apply discount to zero subtotal** (edge case) - Returns 0.0\n39. **Apply discount to negative subtotal** (edge case) - Handle gracefully\n\n### `calculate_shipping`\n\n40. **Subtotal below threshold** (normal use) - Returns shipping_cost\n41. **Subtotal exactly at threshold** (edge case) - Free or paid? Boundary test\n42. **Subtotal above threshold** (normal use) - Returns 0.0 (free shipping)\n43. **Subtotal is zero** (edge case) - Returns shipping_cost\n44. **Subtotal is negative** (edge case) - Handle gracefully\n45. **Custom shipping threshold** (normal use) - Uses configured threshold\n46. **Custom shipping cost** (normal use) - Uses configured cost\n\n### `calculate_tax`\n\n47. **Tax on positive amount** (normal use) - Correct tax calculation\n48. **Tax on zero amount** (edge case) - Returns 0.0\n49. **Tax on negative amount** (edge case) - Handle gracefully\n50. **Tax with default rate (23%)** (normal use) - Correct calculation\n51. **Tax with custom rate** (normal use) - Uses configured rate\n52. **Tax with zero rate** (edge case) - Returns 0.0\n53. **Tax floating-point precision** (edge case) - Handle decimal results\n\n### `calculate_total`\n\n54. **Total with no discount** (normal use) - subtotal + shipping + tax\n55. **Total with discount** (normal use) - (subtotal - discount) + shipping + tax\n56. **Total qualifying for free shipping** (normal use) - No shipping added\n57. **Total not qualifying for free shipping** (normal use) - Shipping added\n58. **Total with empty order** (edge case) - Should return 0.0 or shipping only?\n59. **Total with 100% discount** (edge case) - Handle correctly\n60. **Total with invalid discount** (invalid input) - Should raise exception\n61. **Total integration test** (normal use) - Verify all components combined correctly\n\n### `total_items`\n\n62. **Total items in empty order** (edge case) - Returns 0\n63. **Total items with single item quantity 1** (normal use) - Returns 1\n64. **Total items with single item quantity > 1** (normal use) - Returns quantity\n65. **Total items with multiple items** (normal use) - Sum of all quantities\n\n### `clear_order`\n\n66. **Clear empty order** (edge case) - No error, order remains empty\n67. **Clear order with items** (normal use) - All items removed\n68. **Verify state after clear** (normal use) - is_empty returns True, subtotal is 0\n\n### `list_items`\n\n69. **List items from empty order** (edge case) - Returns empty list\n70. **List items with single item** (normal use) - Returns list with one name\n71. **List items with multiple items** (normal use) - Returns all names\n72. **List items order consistency** (edge case) - Order of names (if deterministic)\n\n### `is_empty`\n\n73. **Empty order check on new order** (normal use) - Returns True\n74. **Empty order check after adding item** (normal use) - Returns False\n75. **Empty order check after removing all items** (normal use) - Returns True\n76. **Empty order check after clear** (normal use) - Returns True\n\n### Integration/State Tests\n\n77. **Add then remove same item** (integration) - Order returns to empty state\n78. **Multiple operations sequence** (integration) - Add, remove, add, calculate correctly\n79. **Order state isolation** (integration) - Multiple OrderCalculator instances don't interfere",
        "response_time": 0
      },
      {
        "step": 3,
        "prompt": "Now, based on the test scenarios you just listed, generate the complete Python unit test suite using the `unittest` framework.\n\nFollow these rules:\n- Include one test method per scenario.\n- Use meaningful test method names.\n- Do not include comments or explanations.\n- Output a valid `.py` file containing only the test class.\n- IMPORTANT: Do NOT copy or redefine the OrderCalculator class in your test file. The class already exists in a separate module. Simply import it using: `from order_calculator import OrderCalculator`\n\nThe output must contain only Python code.",
        "response": "```python\nimport unittest\nfrom order_calculator import OrderCalculator\n\n\nclass TestOrderCalculatorInit(unittest.TestCase):\n\n    def test_default_parameters(self):\n        calc = OrderCalculator()\n        self.assertEqual(calc.tax_rate, 0.23)\n        self.assertEqual(calc.free_shipping_threshold, 100.0)\n        self.assertEqual(calc.shipping_cost, 10.0)\n\n    def test_custom_parameters(self):\n        calc = OrderCalculator(tax_rate=0.1, free_shipping_threshold=50.0, shipping_cost=5.0)\n        self.assertEqual(calc.tax_rate, 0.1)\n        self.assertEqual(calc.free_shipping_threshold, 50.0)\n        self.assertEqual(calc.shipping_cost, 5.0)\n\n    def test_zero_tax_rate(self):\n        calc = OrderCalculator(tax_rate=0.0)\n        self.assertEqual(calc.tax_rate, 0.0)\n\n    def test_zero_shipping_threshold(self):\n        calc = OrderCalculator(free_shipping_threshold=0.0)\n        self.assertEqual(calc.free_shipping_threshold, 0.0)\n\n    def test_zero_shipping_cost(self):\n        calc = OrderCalculator(shipping_cost=0.0)\n        self.assertEqual(calc.shipping_cost, 0.0)\n\n    def test_negative_tax_rate(self):\n        with self.assertRaises(ValueError):\n            OrderCalculator(tax_rate=-0.1)\n\n    def test_negative_shipping_threshold(self):\n        with self.assertRaises(ValueError):\n            OrderCalculator(free_shipping_threshold=-10.0)\n\n    def test_negative_shipping_cost(self):\n        with self.assertRaises(ValueError):\n            OrderCalculator(shipping_cost=-5.0)\n\n\nclass TestAddItem(unittest.TestCase):\n\n    def test_add_single_item(self):\n        calc = OrderCalculator()\n        calc.add_item(\"Apple\", 1.50, 3)\n        self.assertEqual(calc.total_items(), 3)\n        self.assertIn(\"Apple\", calc.list_items())\n\n    def test_add_item_default_quantity(self):\n        calc = OrderCalculator()\n        calc.add_item(\"Banana\", 2.00)\n        self.assertEqual(calc.total_items(), 1)\n\n    def test_add_item_custom_quantity(self):\n        calc = OrderCalculator()\n        calc.add_item(\"Orange\", 3.00, 5)\n        self.assertEqual(calc.total_items(), 5)\n\n    def test_add_multiple_different_items(self):\n        calc = OrderCalculator()\n        calc.add_item(\"Apple\", 1.50, 2)\n        calc.add_item(\"Banana\", 2.00, 3)\n        self.assertEqual(len(calc.list_items()), 2)\n        self.assertEqual(calc.total_items(), 5)\n\n    def test_add_duplicate_item_name(self):\n        calc = OrderCalculator()\n        calc.add_item(\"Apple\", 1.50, 2)\n        calc.add_item(\"Apple\", 1.50, 3)\n        self.assertEqual(calc.total_items(), 5)\n\n    def test_add_item_zero_price(self):\n        calc = OrderCalculator()\n        calc.add_item(\"FreeItem\", 0.0, 1)\n        self.assertEqual(calc.get_subtotal(), 0.0)\n\n    def test_add_item_negative_price(self):\n        calc = OrderCalculator()\n        with self.assertRaises(ValueError):\n            calc.add_item(\"BadItem\", -5.0, 1)\n\n    def test_add_item_zero_quantity(self):\n        calc = OrderCalculator()\n        with self.assertRaises(ValueError):\n            calc.add_item(\"ZeroItem\", 5.0, 0)\n\n    def test_add_item_negative_quantity(self):\n        calc = OrderCalculator()\n        with self.assertRaises(ValueError):\n            calc.add_item(\"BadItem\", 5.0, -1)\n\n    def test_add_item_empty_name(self):\n        calc = OrderCalculator()\n        with self.assertRaises(ValueError):\n            calc.add_item(\"\", 5.0, 1)\n\n    def test_add_item_very_large_price(self):\n        calc = OrderCalculator()\n        calc.add_item(\"Expensive\", 1000000.0, 1)\n        self.assertEqual(calc.get_subtotal(), 1000000.0)\n\n\nclass TestRemoveItem(unittest.TestCase):\n\n    def test_remove_existing_item(self):\n        calc = OrderCalculator()\n        calc.add_item(\"Apple\", 1.50, 2)\n        calc.remove_item(\"Apple\")\n        self.assertTrue(calc.is_empty())\n\n    def test_remove_non_existing_item(self):\n        calc = OrderCalculator()\n        calc.add_item(\"Apple\", 1.50, 2)\n        with self.assertRaises(ValueError):\n            calc.remove_item(\"Banana\")\n\n    def test_remove_from_empty_order(self):\n        calc = OrderCalculator()\n        with self.assertRaises(ValueError):\n            calc.remove_item(\"Apple\")\n\n    def test_remove_item_and_verify_subtotal_updates(self):\n        calc = OrderCalculator()\n        calc.add_item(\"Apple\", 10.0, 2)\n        calc.add_item(\"Banana\", 5.0, 1)\n        calc.remove_item(\"Apple\")\n        self.assertEqual(calc.get_subtotal(), 5.0)\n\n    def test_remove_one_of_multiple_items(self):\n        calc = OrderCalculator()\n        calc.add_item(\"Apple\", 1.50, 2)\n        calc.add_item(\"Banana\", 2.00, 3)\n        calc.remove_item(\"Apple\")\n        self.assertEqual(len(calc.list_items()), 1)\n        self.assertIn(\"Banana\", calc.list_items())\n\n\nclass TestGetSubtotal(unittest.TestCase):\n\n    def test_subtotal_of_empty_order(self):\n        calc = OrderCalculator()\n        self.assertEqual(calc.get_subtotal(), 0.0)\n\n    def test_subtotal_with_single_item(self):\n        calc = OrderCalculator()\n        calc.add_item(\"Apple\", 2.50, 4)\n        self.assertEqual(calc.get_subtotal(), 10.0)\n\n    def test_subtotal_with_multiple_items(self):\n        calc = OrderCalculator()\n        calc.add_item(\"Apple\", 2.00, 3)\n        calc.add_item(\"Banana\", 1.50, 2)\n        self.assertEqual(calc.get_subtotal(), 9.0)\n\n    def test_subtotal_with_varying_quantities(self):\n        calc = OrderCalculator()\n        calc.add_item(\"A\", 10.0, 1)\n        calc.add_item(\"B\", 5.0, 10)\n        self.assertEqual(calc.get_subtotal(), 60.0)\n\n    def test_subtotal_floating_point_precision(self):\n        calc = OrderCalculator()\n        calc.add_item(\"Item\", 0.1, 3)\n        self.assertAlmostEqual(calc.get_subtotal(), 0.3, places=2)\n\n\nclass TestApplyDiscount(unittest.TestCase):\n\n    def test_apply_zero_discount(self):\n        calc = OrderCalculator()\n        result = calc.apply_discount(100.0, 0.0)\n        self.assertEqual(result, 100.0)\n\n    def test_apply_valid_discount(self):\n        calc = OrderCalculator()\n        result = calc.apply_discount(100.0, 10.0)\n        self.assertEqual(result, 90.0)\n\n    def test_apply_100_percent_discount(self):\n        calc = OrderCalculator()\n        result = calc.apply_discount(100.0, 100.0)\n        self.assertEqual(result, 0.0)\n\n    def test_apply_discount_greater_than_100(self):\n        calc = OrderCalculator()\n        with self.assertRaises(ValueError):\n            calc.apply_discount(100.0, 150.0)\n\n    def test_apply_negative_discount(self):\n        calc = OrderCalculator()\n        with self.assertRaises(ValueError):\n            calc.apply_discount(100.0, -10.0)\n\n    def test_apply_discount_to_zero_subtotal(self):\n        calc = OrderCalculator()\n        result = calc.apply_discount(0.0, 10.0)\n        self.assertEqual(result, 0.0)\n\n\nclass TestCalculateShipping(unittest.TestCase):\n\n    def test_subtotal_below_threshold(self):\n        calc = OrderCalculator(free_shipping_threshold=100.0, shipping_cost=10.0)\n        result = calc.calculate_shipping(50.0)\n        self.assertEqual(result, 10.0)\n\n    def test_subtotal_exactly_at_threshold(self):\n        calc = OrderCalculator(free_shipping_threshold=100.0, shipping_cost=10.0)\n        result = calc.calculate_shipping(100.0)\n        self.assertEqual(result, 0.0)\n\n    def test_subtotal_above_threshold(self):\n        calc = OrderCalculator(free_shipping_threshold=100.0, shipping_cost=10.0)\n        result = calc.calculate_shipping(150.0)\n        self.assertEqual(result, 0.0)\n\n    def test_subtotal_is_zero(self):\n        calc = OrderCalculator(free_shipping_threshold=100.0, shipping_cost=10.0)\n        result = calc.calculate_shipping(0.0)\n        self.assertEqual(result, 10.0)\n\n    def test_custom_shipping_threshold(self):\n        calc = OrderCalculator(free_shipping_threshold=50.0, shipping_cost=10.0)\n        result = calc.calculate_shipping(50.0)\n        self.assertEqual(result, 0.0)\n\n    def test_custom_shipping_cost(self):\n        calc = OrderCalculator(free_shipping_threshold=100.0, shipping_cost=15.0)\n        result = calc.calculate_shipping(50.0)\n        self.assertEqual(result, 15.0)\n\n\nclass TestCalculateTax(unittest.TestCase):\n\n    def test_tax_on_positive_amount(self):\n        calc = OrderCalculator(tax_rate=0.23)\n        result = calc.calculate_tax(100.0)\n        self.assertEqual(result, 23.0)\n\n    def test_tax_on_zero_amount(self):\n        calc = OrderCalculator(tax_rate=0.23)\n        result = calc.calculate_tax(0.0)\n        self.assertEqual(result, 0.0)\n\n    def test_tax_with_default_rate(self):\n        calc = OrderCalculator()\n        result = calc.calculate_tax(100.0)\n        self.assertEqual(result, 23.0)\n\n    def test_tax_with_custom_rate(self):\n        calc = OrderCalculator(tax_rate=0.10)\n        result = calc.calculate_tax(100.0)\n        self.assertEqual(result, 10.0)\n\n    def test_tax_with_zero_rate(self):\n        calc = OrderCalculator(tax_rate=0.0)\n        result = calc.calculate_tax(100.0)\n        self.assertEqual(result, 0.0)\n\n    def test_tax_floating_point_precision(self):\n        calc = OrderCalculator(tax_rate=0.23)\n        result = calc.calculate_tax(33.33)\n        self.assertAlmostEqual(result, 7.6659, places=2)\n\n\nclass TestCalculateTotal(unittest.TestCase):\n\n    def test_total_with_no_discount(self):\n        calc = OrderCalculator(tax_rate=0.23, free_shipping_threshold=100.0, shipping_cost=10.0)\n        calc.add_item(\"Item\", 50.0, 1)\n        total = calc.calculate_total()\n        expected = 50.0 + 10.0 + (50.0 + 10.0) * 0.23\n        self.assertAlmostEqual(total, expected, places=2)\n\n    def test_total_with_discount(self):\n        calc = OrderCalculator(tax_rate=0.23, free_shipping_threshold=100.0, shipping_cost=10.0)\n        calc.add_item(\"Item\", 50.0, 1)\n        total = calc.calculate_total(discount=10.0)\n        discounted = 50.0 * 0.9\n        expected = discounted + 10.0 + (discounted + 10.0) * 0.23\n        self.assertAlmostEqual(total, expected, places=2)\n\n    def test_total_qualifying_for_free_shipping(self):\n        calc = OrderCalculator(tax_rate=0.23, free_shipping_threshold=100.0, shipping_cost=10.0)\n        calc.add_item(\"Item\", 120.0, 1)\n        total = calc.calculate_total()\n        expected = 120.0 + 0.0 + 120.0 * 0.23\n        self.assertAlmostEqual(total, expected, places=2)\n\n    def test_total_not_qualifying_for_free_shipping(self):\n        calc = OrderCalculator(tax_rate=0.23, free_shipping_threshold=100.0, shipping_cost=10.0)\n        calc.add_item(\"Item\", 50.0, 1)\n        total = calc.calculate_total()\n        self.assertGreater(total, 50.0 + 10.0)\n\n    def test_total_with_empty_order(self):\n        calc = OrderCalculator(tax_rate=0.23, free_shipping_threshold=100.0, shipping_cost=10.0)\n        total = calc.calculate_total()\n        expected = 0.0 + 10.0 + 10.0 * 0.23\n        self.assertAlmostEqual(total, expected, places=2)\n\n    def test_total_with_100_percent_discount(self):\n        calc = OrderCalculator(tax_rate=0.23, free_shipping_threshold=100.0, shipping_cost=10.0)\n        calc.add_item(\"Item\", 50.0, 1)\n        total = calc.calculate_total(discount=100.0)\n        expected = 0.0 + 10.0 + 10.0 * 0.23\n        self.assertAlmostEqual(total, expected, places=2)\n\n    def test_total_with_invalid_discount(self):\n        calc = OrderCalculator()\n        calc.add_item(\"Item\", 50.0, 1)\n        with self.assertRaises(ValueError):\n            calc.calculate_total(discount=-10.0)\n\n\nclass TestTotalItems(unittest.TestCase):\n\n    def test_total_items_in_empty_order(self):\n        calc = OrderCalculator()\n        self.assertEqual(calc.total_items(), 0)\n\n    def test_total_items_with_single_item_quantity_one(self):\n        calc = OrderCalculator()\n        calc.add_item(\"Apple\", 1.50, 1)\n        self.assertEqual(calc.total_items(), 1)\n\n    def test_total_items_with_single_item_quantity_greater_than_one(self):\n        calc = OrderCalculator()\n        calc.add_item(\"Apple\", 1.50, 5)\n        self.assertEqual(calc.total_items(), 5)\n\n    def test_total_items_with_multiple_items(self):\n        calc = OrderCalculator()\n        calc.add_item(\"Apple\", 1.50, 2)\n        calc.add_item(\"Banana\", 2.00, 3)\n        calc.add_item(\"Orange\", 3.00, 4)\n        self.assertEqual(calc.total_items(), 9)\n\n\nclass TestClearOrder(unittest.TestCase):\n\n    def test_clear_empty_order(self):\n        calc = OrderCalculator()\n        calc.clear_order()\n        self.assertTrue(calc.is_empty())\n\n    def test_clear_order_with_items(self):\n        calc = OrderCalculator()\n        calc.add_item(\"Apple\", 1.50, 2)\n        calc.add_item(\"Banana\", 2.00, 3)\n        calc.clear_order()\n        self.assertTrue(calc.is_empty())\n\n    def test_verify_state_after_clear(self):\n        calc = OrderCalculator()\n        calc.add_item(\"Apple\", 1.50, 2)\n        calc.clear_order()\n        self.assertTrue(calc.is_empty())\n        self.assertEqual(calc.get_subtotal(), 0.0)\n        self.assertEqual(calc.total_items(), 0)\n        self.assertEqual(calc.list_items(), [])\n\n\nclass TestListItems(unittest.TestCase):\n\n    def test_list_items_from_empty_order(self):\n        calc = OrderCalculator()\n        self.assertEqual(calc.list_items(), [])\n\n    def test_list_items_with_single_item(self):\n        calc = OrderCalculator()\n        calc.add_item(\"Apple\", 1.50, 2)\n        self.assertEqual(calc.list_items(), [\"Apple\"])\n\n    def test_list_items_with_multiple_items(self):\n        calc = OrderCalculator()\n        calc.add_item(\"Apple\", 1.50, 2)\n        calc.add_item(\"Banana\", 2.00, 3)\n        items = calc.list_items()\n        self.assertEqual(len(items), 2)\n        self.assertIn(\"Apple\", items)\n        self.assertIn(\"Banana\", items)\n\n\nclass TestIsEmpty(unittest.TestCase):\n\n    def test_empty_order_check_on_new_order(self):\n        calc = OrderCalculator()\n        self.assertTrue(calc.is_empty())\n\n    def test_empty_order_check_after_adding_item(self):\n        calc = OrderCalculator()\n        calc.add_item(\"Apple\", 1.50, 2)\n        self.assertFalse(calc.is_empty())\n\n    def test_empty_order_check_after_removing_all_items(self):\n        calc = OrderCalculator()\n        calc.add_item(\"Apple\", 1.50, 2)\n        calc.remove_item(\"Apple\")\n        self.assertTrue(calc.is_empty())\n\n    def test_empty_order_check_after_clear(self):\n        calc = OrderCalculator()\n        calc.add_item(\"Apple\", 1.50, 2)\n        calc.clear_order()\n        self.assertTrue(calc.is_empty())\n\n\nclass TestIntegration(unittest.TestCase):\n\n    def test_add_then_remove_same_item(self):\n        calc = OrderCalculator()\n        calc.add_item(\"Apple\", 1.50, 2)\n        calc.remove_item(\"Apple\")\n        self.assertTrue(calc.is_empty())\n        self.assertEqual(calc.get_subtotal(), 0.0)\n\n    def test_multiple_operations_sequence(self):\n        calc = OrderCalculator(tax_rate=0.10, free_shipping_threshold=50.0, shipping_cost=5.0)\n        calc.add_item(\"A\", 10.0, 2)\n        calc.add_item(\"B\", 15.0, 1)\n        calc.remove_item(\"A\")\n        calc.add_item(\"C\", 20.0, 2)\n        self.assertEqual(calc.get_subtotal(), 55.0)\n        self.assertEqual(calc.total_items(), 3)\n        total = calc.calculate_total(discount=10.0)\n        discounted = 55.0 * 0.9\n        expected = discounted + 0.0 + discounted * 0.10\n        self.assertAlmostEqual(total, expected, places=2)\n\n    def test_order_state_isolation(self):\n        calc1 = OrderCalculator()\n        calc2 = OrderCalculator()\n        calc1.add_item(\"Apple\", 1.50, 2)\n        self.assertFalse(calc1.is_empty())\n        self.assertTrue(calc2.is_empty())\n\n\nif __name__ == \"__main__\":\n    unittest.main()\n```",
        "response_time": 0
      }
    ],
    "final_response": "```python\nimport unittest\nfrom order_calculator import OrderCalculator\n\n\nclass TestOrderCalculatorInit(unittest.TestCase):\n\n    def test_default_parameters(self):\n        calc = OrderCalculator()\n        self.assertEqual(calc.tax_rate, 0.23)\n        self.assertEqual(calc.free_shipping_threshold, 100.0)\n        self.assertEqual(calc.shipping_cost, 10.0)\n\n    def test_custom_parameters(self):\n        calc = OrderCalculator(tax_rate=0.1, free_shipping_threshold=50.0, shipping_cost=5.0)\n        self.assertEqual(calc.tax_rate, 0.1)\n        self.assertEqual(calc.free_shipping_threshold, 50.0)\n        self.assertEqual(calc.shipping_cost, 5.0)\n\n    def test_zero_tax_rate(self):\n        calc = OrderCalculator(tax_rate=0.0)\n        self.assertEqual(calc.tax_rate, 0.0)\n\n    def test_zero_shipping_threshold(self):\n        calc = OrderCalculator(free_shipping_threshold=0.0)\n        self.assertEqual(calc.free_shipping_threshold, 0.0)\n\n    def test_zero_shipping_cost(self):\n        calc = OrderCalculator(shipping_cost=0.0)\n        self.assertEqual(calc.shipping_cost, 0.0)\n\n    def test_negative_tax_rate(self):\n        with self.assertRaises(ValueError):\n            OrderCalculator(tax_rate=-0.1)\n\n    def test_negative_shipping_threshold(self):\n        with self.assertRaises(ValueError):\n            OrderCalculator(free_shipping_threshold=-10.0)\n\n    def test_negative_shipping_cost(self):\n        with self.assertRaises(ValueError):\n            OrderCalculator(shipping_cost=-5.0)\n\n\nclass TestAddItem(unittest.TestCase):\n\n    def test_add_single_item(self):\n        calc = OrderCalculator()\n        calc.add_item(\"Apple\", 1.50, 3)\n        self.assertEqual(calc.total_items(), 3)\n        self.assertIn(\"Apple\", calc.list_items())\n\n    def test_add_item_default_quantity(self):\n        calc = OrderCalculator()\n        calc.add_item(\"Banana\", 2.00)\n        self.assertEqual(calc.total_items(), 1)\n\n    def test_add_item_custom_quantity(self):\n        calc = OrderCalculator()\n        calc.add_item(\"Orange\", 3.00, 5)\n        self.assertEqual(calc.total_items(), 5)\n\n    def test_add_multiple_different_items(self):\n        calc = OrderCalculator()\n        calc.add_item(\"Apple\", 1.50, 2)\n        calc.add_item(\"Banana\", 2.00, 3)\n        self.assertEqual(len(calc.list_items()), 2)\n        self.assertEqual(calc.total_items(), 5)\n\n    def test_add_duplicate_item_name(self):\n        calc = OrderCalculator()\n        calc.add_item(\"Apple\", 1.50, 2)\n        calc.add_item(\"Apple\", 1.50, 3)\n        self.assertEqual(calc.total_items(), 5)\n\n    def test_add_item_zero_price(self):\n        calc = OrderCalculator()\n        calc.add_item(\"FreeItem\", 0.0, 1)\n        self.assertEqual(calc.get_subtotal(), 0.0)\n\n    def test_add_item_negative_price(self):\n        calc = OrderCalculator()\n        with self.assertRaises(ValueError):\n            calc.add_item(\"BadItem\", -5.0, 1)\n\n    def test_add_item_zero_quantity(self):\n        calc = OrderCalculator()\n        with self.assertRaises(ValueError):\n            calc.add_item(\"ZeroItem\", 5.0, 0)\n\n    def test_add_item_negative_quantity(self):\n        calc = OrderCalculator()\n        with self.assertRaises(ValueError):\n            calc.add_item(\"BadItem\", 5.0, -1)\n\n    def test_add_item_empty_name(self):\n        calc = OrderCalculator()\n        with self.assertRaises(ValueError):\n            calc.add_item(\"\", 5.0, 1)\n\n    def test_add_item_very_large_price(self):\n        calc = OrderCalculator()\n        calc.add_item(\"Expensive\", 1000000.0, 1)\n        self.assertEqual(calc.get_subtotal(), 1000000.0)\n\n\nclass TestRemoveItem(unittest.TestCase):\n\n    def test_remove_existing_item(self):\n        calc = OrderCalculator()\n        calc.add_item(\"Apple\", 1.50, 2)\n        calc.remove_item(\"Apple\")\n        self.assertTrue(calc.is_empty())\n\n    def test_remove_non_existing_item(self):\n        calc = OrderCalculator()\n        calc.add_item(\"Apple\", 1.50, 2)\n        with self.assertRaises(ValueError):\n            calc.remove_item(\"Banana\")\n\n    def test_remove_from_empty_order(self):\n        calc = OrderCalculator()\n        with self.assertRaises(ValueError):\n            calc.remove_item(\"Apple\")\n\n    def test_remove_item_and_verify_subtotal_updates(self):\n        calc = OrderCalculator()\n        calc.add_item(\"Apple\", 10.0, 2)\n        calc.add_item(\"Banana\", 5.0, 1)\n        calc.remove_item(\"Apple\")\n        self.assertEqual(calc.get_subtotal(), 5.0)\n\n    def test_remove_one_of_multiple_items(self):\n        calc = OrderCalculator()\n        calc.add_item(\"Apple\", 1.50, 2)\n        calc.add_item(\"Banana\", 2.00, 3)\n        calc.remove_item(\"Apple\")\n        self.assertEqual(len(calc.list_items()), 1)\n        self.assertIn(\"Banana\", calc.list_items())\n\n\nclass TestGetSubtotal(unittest.TestCase):\n\n    def test_subtotal_of_empty_order(self):\n        calc = OrderCalculator()\n        self.assertEqual(calc.get_subtotal(), 0.0)\n\n    def test_subtotal_with_single_item(self):\n        calc = OrderCalculator()\n        calc.add_item(\"Apple\", 2.50, 4)\n        self.assertEqual(calc.get_subtotal(), 10.0)\n\n    def test_subtotal_with_multiple_items(self):\n        calc = OrderCalculator()\n        calc.add_item(\"Apple\", 2.00, 3)\n        calc.add_item(\"Banana\", 1.50, 2)\n        self.assertEqual(calc.get_subtotal(), 9.0)\n\n    def test_subtotal_with_varying_quantities(self):\n        calc = OrderCalculator()\n        calc.add_item(\"A\", 10.0, 1)\n        calc.add_item(\"B\", 5.0, 10)\n        self.assertEqual(calc.get_subtotal(), 60.0)\n\n    def test_subtotal_floating_point_precision(self):\n        calc = OrderCalculator()\n        calc.add_item(\"Item\", 0.1, 3)\n        self.assertAlmostEqual(calc.get_subtotal(), 0.3, places=2)\n\n\nclass TestApplyDiscount(unittest.TestCase):\n\n    def test_apply_zero_discount(self):\n        calc = OrderCalculator()\n        result = calc.apply_discount(100.0, 0.0)\n        self.assertEqual(result, 100.0)\n\n    def test_apply_valid_discount(self):\n        calc = OrderCalculator()\n        result = calc.apply_discount(100.0, 10.0)\n        self.assertEqual(result, 90.0)\n\n    def test_apply_100_percent_discount(self):\n        calc = OrderCalculator()\n        result = calc.apply_discount(100.0, 100.0)\n        self.assertEqual(result, 0.0)\n\n    def test_apply_discount_greater_than_100(self):\n        calc = OrderCalculator()\n        with self.assertRaises(ValueError):\n            calc.apply_discount(100.0, 150.0)\n\n    def test_apply_negative_discount(self):\n        calc = OrderCalculator()\n        with self.assertRaises(ValueError):\n            calc.apply_discount(100.0, -10.0)\n\n    def test_apply_discount_to_zero_subtotal(self):\n        calc = OrderCalculator()\n        result = calc.apply_discount(0.0, 10.0)\n        self.assertEqual(result, 0.0)\n\n\nclass TestCalculateShipping(unittest.TestCase):\n\n    def test_subtotal_below_threshold(self):\n        calc = OrderCalculator(free_shipping_threshold=100.0, shipping_cost=10.0)\n        result = calc.calculate_shipping(50.0)\n        self.assertEqual(result, 10.0)\n\n    def test_subtotal_exactly_at_threshold(self):\n        calc = OrderCalculator(free_shipping_threshold=100.0, shipping_cost=10.0)\n        result = calc.calculate_shipping(100.0)\n        self.assertEqual(result, 0.0)\n\n    def test_subtotal_above_threshold(self):\n        calc = OrderCalculator(free_shipping_threshold=100.0, shipping_cost=10.0)\n        result = calc.calculate_shipping(150.0)\n        self.assertEqual(result, 0.0)\n\n    def test_subtotal_is_zero(self):\n        calc = OrderCalculator(free_shipping_threshold=100.0, shipping_cost=10.0)\n        result = calc.calculate_shipping(0.0)\n        self.assertEqual(result, 10.0)\n\n    def test_custom_shipping_threshold(self):\n        calc = OrderCalculator(free_shipping_threshold=50.0, shipping_cost=10.0)\n        result = calc.calculate_shipping(50.0)\n        self.assertEqual(result, 0.0)\n\n    def test_custom_shipping_cost(self):\n        calc = OrderCalculator(free_shipping_threshold=100.0, shipping_cost=15.0)\n        result = calc.calculate_shipping(50.0)\n        self.assertEqual(result, 15.0)\n\n\nclass TestCalculateTax(unittest.TestCase):\n\n    def test_tax_on_positive_amount(self):\n        calc = OrderCalculator(tax_rate=0.23)\n        result = calc.calculate_tax(100.0)\n        self.assertEqual(result, 23.0)\n\n    def test_tax_on_zero_amount(self):\n        calc = OrderCalculator(tax_rate=0.23)\n        result = calc.calculate_tax(0.0)\n        self.assertEqual(result, 0.0)\n\n    def test_tax_with_default_rate(self):\n        calc = OrderCalculator()\n        result = calc.calculate_tax(100.0)\n        self.assertEqual(result, 23.0)\n\n    def test_tax_with_custom_rate(self):\n        calc = OrderCalculator(tax_rate=0.10)\n        result = calc.calculate_tax(100.0)\n        self.assertEqual(result, 10.0)\n\n    def test_tax_with_zero_rate(self):\n        calc = OrderCalculator(tax_rate=0.0)\n        result = calc.calculate_tax(100.0)\n        self.assertEqual(result, 0.0)\n\n    def test_tax_floating_point_precision(self):\n        calc = OrderCalculator(tax_rate=0.23)\n        result = calc.calculate_tax(33.33)\n        self.assertAlmostEqual(result, 7.6659, places=2)\n\n\nclass TestCalculateTotal(unittest.TestCase):\n\n    def test_total_with_no_discount(self):\n        calc = OrderCalculator(tax_rate=0.23, free_shipping_threshold=100.0, shipping_cost=10.0)\n        calc.add_item(\"Item\", 50.0, 1)\n        total = calc.calculate_total()\n        expected = 50.0 + 10.0 + (50.0 + 10.0) * 0.23\n        self.assertAlmostEqual(total, expected, places=2)\n\n    def test_total_with_discount(self):\n        calc = OrderCalculator(tax_rate=0.23, free_shipping_threshold=100.0, shipping_cost=10.0)\n        calc.add_item(\"Item\", 50.0, 1)\n        total = calc.calculate_total(discount=10.0)\n        discounted = 50.0 * 0.9\n        expected = discounted + 10.0 + (discounted + 10.0) * 0.23\n        self.assertAlmostEqual(total, expected, places=2)\n\n    def test_total_qualifying_for_free_shipping(self):\n        calc = OrderCalculator(tax_rate=0.23, free_shipping_threshold=100.0, shipping_cost=10.0)\n        calc.add_item(\"Item\", 120.0, 1)\n        total = calc.calculate_total()\n        expected = 120.0 + 0.0 + 120.0 * 0.23\n        self.assertAlmostEqual(total, expected, places=2)\n\n    def test_total_not_qualifying_for_free_shipping(self):\n        calc = OrderCalculator(tax_rate=0.23, free_shipping_threshold=100.0, shipping_cost=10.0)\n        calc.add_item(\"Item\", 50.0, 1)\n        total = calc.calculate_total()\n        self.assertGreater(total, 50.0 + 10.0)\n\n    def test_total_with_empty_order(self):\n        calc = OrderCalculator(tax_rate=0.23, free_shipping_threshold=100.0, shipping_cost=10.0)\n        total = calc.calculate_total()\n        expected = 0.0 + 10.0 + 10.0 * 0.23\n        self.assertAlmostEqual(total, expected, places=2)\n\n    def test_total_with_100_percent_discount(self):\n        calc = OrderCalculator(tax_rate=0.23, free_shipping_threshold=100.0, shipping_cost=10.0)\n        calc.add_item(\"Item\", 50.0, 1)\n        total = calc.calculate_total(discount=100.0)\n        expected = 0.0 + 10.0 + 10.0 * 0.23\n        self.assertAlmostEqual(total, expected, places=2)\n\n    def test_total_with_invalid_discount(self):\n        calc = OrderCalculator()\n        calc.add_item(\"Item\", 50.0, 1)\n        with self.assertRaises(ValueError):\n            calc.calculate_total(discount=-10.0)\n\n\nclass TestTotalItems(unittest.TestCase):\n\n    def test_total_items_in_empty_order(self):\n        calc = OrderCalculator()\n        self.assertEqual(calc.total_items(), 0)\n\n    def test_total_items_with_single_item_quantity_one(self):\n        calc = OrderCalculator()\n        calc.add_item(\"Apple\", 1.50, 1)\n        self.assertEqual(calc.total_items(), 1)\n\n    def test_total_items_with_single_item_quantity_greater_than_one(self):\n        calc = OrderCalculator()\n        calc.add_item(\"Apple\", 1.50, 5)\n        self.assertEqual(calc.total_items(), 5)\n\n    def test_total_items_with_multiple_items(self):\n        calc = OrderCalculator()\n        calc.add_item(\"Apple\", 1.50, 2)\n        calc.add_item(\"Banana\", 2.00, 3)\n        calc.add_item(\"Orange\", 3.00, 4)\n        self.assertEqual(calc.total_items(), 9)\n\n\nclass TestClearOrder(unittest.TestCase):\n\n    def test_clear_empty_order(self):\n        calc = OrderCalculator()\n        calc.clear_order()\n        self.assertTrue(calc.is_empty())\n\n    def test_clear_order_with_items(self):\n        calc = OrderCalculator()\n        calc.add_item(\"Apple\", 1.50, 2)\n        calc.add_item(\"Banana\", 2.00, 3)\n        calc.clear_order()\n        self.assertTrue(calc.is_empty())\n\n    def test_verify_state_after_clear(self):\n        calc = OrderCalculator()\n        calc.add_item(\"Apple\", 1.50, 2)\n        calc.clear_order()\n        self.assertTrue(calc.is_empty())\n        self.assertEqual(calc.get_subtotal(), 0.0)\n        self.assertEqual(calc.total_items(), 0)\n        self.assertEqual(calc.list_items(), [])\n\n\nclass TestListItems(unittest.TestCase):\n\n    def test_list_items_from_empty_order(self):\n        calc = OrderCalculator()\n        self.assertEqual(calc.list_items(), [])\n\n    def test_list_items_with_single_item(self):\n        calc = OrderCalculator()\n        calc.add_item(\"Apple\", 1.50, 2)\n        self.assertEqual(calc.list_items(), [\"Apple\"])\n\n    def test_list_items_with_multiple_items(self):\n        calc = OrderCalculator()\n        calc.add_item(\"Apple\", 1.50, 2)\n        calc.add_item(\"Banana\", 2.00, 3)\n        items = calc.list_items()\n        self.assertEqual(len(items), 2)\n        self.assertIn(\"Apple\", items)\n        self.assertIn(\"Banana\", items)\n\n\nclass TestIsEmpty(unittest.TestCase):\n\n    def test_empty_order_check_on_new_order(self):\n        calc = OrderCalculator()\n        self.assertTrue(calc.is_empty())\n\n    def test_empty_order_check_after_adding_item(self):\n        calc = OrderCalculator()\n        calc.add_item(\"Apple\", 1.50, 2)\n        self.assertFalse(calc.is_empty())\n\n    def test_empty_order_check_after_removing_all_items(self):\n        calc = OrderCalculator()\n        calc.add_item(\"Apple\", 1.50, 2)\n        calc.remove_item(\"Apple\")\n        self.assertTrue(calc.is_empty())\n\n    def test_empty_order_check_after_clear(self):\n        calc = OrderCalculator()\n        calc.add_item(\"Apple\", 1.50, 2)\n        calc.clear_order()\n        self.assertTrue(calc.is_empty())\n\n\nclass TestIntegration(unittest.TestCase):\n\n    def test_add_then_remove_same_item(self):\n        calc = OrderCalculator()\n        calc.add_item(\"Apple\", 1.50, 2)\n        calc.remove_item(\"Apple\")\n        self.assertTrue(calc.is_empty())\n        self.assertEqual(calc.get_subtotal(), 0.0)\n\n    def test_multiple_operations_sequence(self):\n        calc = OrderCalculator(tax_rate=0.10, free_shipping_threshold=50.0, shipping_cost=5.0)\n        calc.add_item(\"A\", 10.0, 2)\n        calc.add_item(\"B\", 15.0, 1)\n        calc.remove_item(\"A\")\n        calc.add_item(\"C\", 20.0, 2)\n        self.assertEqual(calc.get_subtotal(), 55.0)\n        self.assertEqual(calc.total_items(), 3)\n        total = calc.calculate_total(discount=10.0)\n        discounted = 55.0 * 0.9\n        expected = discounted + 0.0 + discounted * 0.10\n        self.assertAlmostEqual(total, expected, places=2)\n\n    def test_order_state_isolation(self):\n        calc1 = OrderCalculator()\n        calc2 = OrderCalculator()\n        calc1.add_item(\"Apple\", 1.50, 2)\n        self.assertFalse(calc1.is_empty())\n        self.assertTrue(calc2.is_empty())\n\n\nif __name__ == \"__main__\":\n    unittest.main()\n```",
    "total_response_time": 164.4903028011322,
    "strategy": "chain_of_thought_prompting",
    "context_type": "interface"
  }
}